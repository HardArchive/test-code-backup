<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0057)http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx -->
<HTML><HEAD><TITLE>Listing Used Files - CodeProject</TITLE><LINK rel=stylesheet 
type=text/css 
href="Listing%20Used%20Files%20-%20CodeProject_files/CodeProject.min.css">
<META content="text/html; charset=utf-8" http-equiv=Content-Type>
<META name=Description 
content='A ShellExtension that lists all the used files in a folder.; Author: <font color="0xFF000000">N</font>aveen; Section: Shell and IE programming; Chapter: Desktop Development'>
<META name=Keywords 
content="VC6, Windows, Dev, Intermediate,Shell and IE programming,Desktop Development,Free source code, tutorials">
<META name=Author content='<font color="0xFF000000">N</font>aveen'>
<META name=Rating content=General>
<META name=Robots content="index, follow">
<META name=Revisit-After content="1 days">
<META name=google-site-verification 
content=RP2bNCUeOmNkkJesEnU8X3UyTbqIcCKP0CmdwU8in5k>
<META name=msapplication-navbutton-color content=#FF9900><LINK 
title="CodeProject Latest articles - All topics" rel=alternate 
type=application/rss+xml 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1"><LINK 
title="CodeProject Latest articles - MFC / C++" rel=alternate 
type=application/rss+xml 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2"><LINK 
title="CodeProject Latest articles - C#" rel=alternate type=application/rss+xml 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3"><LINK 
title="CodeProject Latest articles - ASP.NET" rel=alternate 
type=application/rss+xml 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4"><LINK 
title="CodeProject Latest articles - .NET" rel=alternate 
type=application/rss+xml 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5"><LINK 
title="CodeProject Latest articles - VB.NET" rel=alternate 
type=application/rss+xml 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6"><LINK 
title="CodeProject Lounge Postings" rel=alternate type=application/rss+xml 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx"><LINK 
title=CodeProject rel=search type=application/opensearchdescription+xml 
href="http://www.codeproject.com/info/OpenSearch.xml"><LINK rel=icon 
type=image/ico href="/favicon.ico"><LINK rel="shortcut icon" type=image/ico 
href="/favicon.ico"><LINK rel=apple-touch-icon type=image/png 
href="/images/FavIcon-Apple.png">
<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
if(top!=self)top.location.href=location.href; if(typeof(DemoUrl)!="undefined")document.write(unescape('%3Cme')+'ta http'+'-equiv="re' +'fresh" con'+'tent="1;url='+DemoUrl+unescape('"%3CE'));
function SelfCheck(){ return window.confirm("You are about to reply to your own message. Is this really what you want?");}
function MarkAns(MemberID,MsgID,gp,bp,mt,QID){
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\"  onclick=\"RateMsg("+MemberID.toString()+","+MsgID.toString()+",6,"+QID.toString()+");\"%3E"));
 document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/good.png\" alt=\"good\" border=\"0\" align=\"absmiddle\" /%3E "+gp+" "+mt+"%3C/a%3E "));
 document.write(" &nbsp;"); document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\"  onclick=\"RateMsg("+MemberID.toString()+","+MsgID.toString()+",7,"+QID.toString()+");\"%3E"));
 document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/bad.png\" alt=\"bad\" border=\"0\" align=\"absmiddle\" /%3E "+bp+" "+mt+"%3C/a%3E"));
}

function MsgVFrm(MemberID,MsgID,GB,gp,bp,mt){
 if(!GB)document.write("Rate this message: ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"5":"1")+unescape(",0);\"%3E"));
 if(GB) document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/good.png\" alt=\"good\" border=\"0\" align=\"absmiddle\" /%3E "+gp+" "+mt+"%3C/a%3E "));
 else document.write(unescape("%3Cimg height=\"14px\" width=\"14px\" src=\"/script/Forums/Images/thumbs_down.gif\" alt=\"vote 1\" border=\"0\" align=\"middle\" /%3E%3C/a%3E "));
 if(GB)document.write(" &nbsp;"); else for(var i=1; i<=5;i++)
  document.write(unescape("%3Ca class=\"toolbar\" href=\"#xx" + MsgID.toString() + "xx\" title=\"vote this message a " + i.toString() + "\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", " + i.toString() + ",0)\"%3E%3Cb%3E" + i.toString() + "%3C/b%3E%3C/a%3E "));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"1":"5")+unescape(",0);\"%3E"));
 if(GB)document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/bad.png\" alt=\"bad\" border=\"0\" align=\"absmiddle\" /%3E "+bp+" "+mt+"%3C/a%3E"));
 else document.write(unescape("%3Cimg height=\"14px\" width=\"14px\" src=\"/script/Forums/Images/thumbs_up.gif\" border=\"0\" alt=\"vote 5\" align=\"middle\" /%3E%3C/a%3E "));
}

function ReportMsg(userid, msgid, score) {
 if (confirm("Are you sure you want this message removed?"))
  return RateMsg(userid, msgid, score, 0);
 else return false;
}
function RateMsg(memberid, msgid, score, questionId) {
 var req = new ActiveXObject("MSXML2.XMLHTTP");
 req.onreadystatechange = function() {
  if (req.readyState == 4){
   if (req.status == 200){
    var respText = req.responseText;
    var re = new RegExp(unescape("\%3Cdiv\%3E(.*)\%3C/div\%3E"), "g");
    var match = re.exec(respText);
    voteStatus.innerHTML = unescape("%3Cb%3E") + (match&&match.length>1&&match[1])?match[1]:"An error occured" + unescape("%3C/b%3E");
   } else
    voteStatus.innerHTML = unescape("%3Cb style='color:red'%3EFailed!") + req.statusText + unescape("%3C/b%3E");
  }
 }
 var voteStatus = document.getElementById("MVF" + msgid);
 if (!voteStatus) return;
 voteStatus.innerHTML = unescape("%3Cb style='color:green'%3EVoting...%3C/b%3E");
 var strAction = "/script/Forums/Vote.aspx?js=1&fmid="+memberid.toString()+"&select="+msgid.toString()+"&score="+score.toString()+"&qid="+questionId.toString();
 req.open("GET", strAction, true);
 req.send(null);
  return false;
}
var Selected = "-1";
function Pin(elm){
 CloseMsg(Selected);
 Selected=''
 var wrk=elm.parentNode; if(wrk)wrk=wrk.children[0];
 var fc=elm?elm.firstChild:null;
 if (wrk&&!wrk.pinned) {
  OpenMsg(wrk.name, true);wrk.pinned=true;fc.src='/script/forums/images/pinned.gif';fc.title='Pinned. Click to unpin'
 } else {
  wrk.pinned=false;CloseMsg(wrk.name); fc.src='/script/forums/images/pin.gif';fc.title='Click to pin message'
 }
 return false;
}
function CloseMsg(msgId) {
 if(!msgId||msgId==''||msgId<0)return;
 var lnk=document.getElementsByName(msgId);
 if(lnk&&lnk.length>0&&lnk[0].pinned)return;
 var hed=document.getElementById('F' + msgId.toString() + '_h0');
 if(hed) hed.className = hed.className.replace("Sel", "UnSel");
 var bdy=document.getElementById('F' + msgId.toString() + '_h1');
 if(bdy) bdy.style.display = 'none';
}
function OpenMsg(msgId, keep) {
 if(!msgId||msgId==''||msgId<0)return;
 var bdy=document.getElementById('F' + msgId.toString() + '_h1');
 if(bdy){
  var lnk=document.getElementsByName(msgId);
  if(lnk&&lnk.length>0&&lnk[0].pinned)keep=true;
  if(keep&&bdy.style.display!='none')return;
  if(bdy.style.display=='none') bdy.style.display='';
  else bdy.style.display = 'none';
 }
 var hed=document.getElementById('F' + msgId.toString() + '_h0');
 if (hed) hed.className = hed.className.replace('UnSel', 'Sel');
 if(bdy&&hed&&bdy.style.display!='none'){
  var webkitWeird=document.documentElement.scrollTop < document.body.scrollTop;
  if (!webkitWeird)document.body.scrollTop = getRealPos(hed, 'Top') - document.body.clientHeight/10;
  EnsureMessageVisible(msgId, true);
 }
}
function EnsureMessageVisible(msgID, bShowTop) {
	var webkitWeird = document.documentElement.scrollTop < document.body.scrollTop;
	var msgHeader = document.getElementById('F' + msgID + '_h0');
	var msgBody = document.getElementById('F' + msgID + '_h1');
	if (!msgBody || !msgHeader) return;
	var scrollContainer = document.documentElement;
	var top = getRealPos(msgHeader, 'Top');
	var bottom = getRealPos(msgBody, 'Top') + msgBody.offsetHeight;
	var scrollTop = webkitWeird? scrollTop = document.body.scrollTop:document.documentElement.scrollTop;
	if (scrollTop > top && !bShowTop) scrollTop = top - scrollContainer.clientHeight / 10;
	if (scrollTop + scrollContainer.clientHeight < bottom) scrollTop = bottom - scrollContainer.clientHeight;
	if (scrollTop > top && bShowTop) scrollTop = top - scrollContainer.clientHeight / 10;
	if (webkitWeird) document.body.scrollTop = scrollTop; else scrollContainer.scrollTop = scrollTop;
}
function getRealPos(i,which) {
	iPos = 0;
	while (i!=null)  {
		iPos += i['offset' + which];
		i = i.offsetParent;
	}
	return iPos;
}

function SwitchMessage(e, msgId)
{

  if (msgId) msgId=msgId.toString();

  else {

    if(!e)e=window.event;

    var target=e.target?e.target:e.srcElement;

    while(target&&target.className!='message-link')target=target.parentNode;
    if(!target||target.className!='message-link')return;
    if(target.pinned){/*Selected='';*/return false;}
    msgId=target.name;
  }
  CloseMsg(Selected)
  if(Selected==msgId) Selected='';
  else { OpenMsg(msgId, false); Selected=msgId;}
  if (e){if(e.preventDefault)e.preventDefault;else e.returnValue=false;}
  return false;
}


//]]>
</SCRIPT>

<META name=GENERATOR content="MSHTML 8.00.6001.19088"></HEAD>
<BODY class=IE8><A 
href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#Main"><IMG 
class=access-link alt="Click here to Skip to main content" 
src="Listing%20Used%20Files%20-%20CodeProject_files/t.gif"></A> 
<DIV class=page-background>
<DIV id=A class=container-content>
<DIV class="container nav-memberbar clearfix">
<DIV class="member-stats float-left">7,895,511 members and growing! (37,854 
online)</DIV>
<DIV class=float-left></DIV>
<DIV class=float-right><SPAN class="tooltip member-message"><IMG 
style="PADDING-BOTTOM: 3px; VERTICAL-ALIGN: bottom" 
src="Listing%20Used%20Files%20-%20CodeProject_files/envelope11.gif" width=11 
height=11> 
<DIV class="tooltip-flyout small-text">
<DIV id=ctl00_MemberMenu_Messages_Confirm><A 
id=ctl00_MemberMenu_Messages_EmailConfirm 
href="http://www.codeproject.com/script/Membership/ConfirmEmail.aspx?tg=770367105450334">Your 
email address needs to be confirmed.</A></DIV>
<UL></UL></DIV></SPAN><SPAN id=ctl00_MemberMenu_CurRat class=tooltip><A 
id=ctl00_MemberMenu_MyProfile 
href="http://www.codeproject.com/Members/wubuxiansheng">wubuxiansheng</A><IMG 
style="WIDTH: 16px; HEIGHT: 16px; VERTICAL-ALIGN: bottom" 
src="Listing%20Used%20Files%20-%20CodeProject_files/arrow-down-16.png"> 
<DIV style="WIDTH: 110px !important" class=tooltip-flyout>
<DIV><A id=ctl00_MemberMenu_MySettingsNonSSL 
href="http://www.codeproject.com/script/Membership/Modify.aspx">My 
Settings</A></DIV>
<DIV></DIV>
<DIV><A id=ctl00_MemberMenu_MyContacts 
href="http://www.codeproject.com/script/Membership/ListContacts.aspx">My Contact 
info</A></DIV>
<DIV><A id=ctl00_MemberMenu_MyBookmarks 
href="http://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2">My 
Bookmarks</A></DIV>
<DIV><A id=ctl00_MemberMenu_MyCodeProject 
href="http://www.codeproject.com/script/Membership/MyCodeProject.aspx">My 
Watched Items</A></DIV>
<DIV><A id=ctl00_MemberMenu_MyArticles 
href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=7063922">My 
Articles</A></DIV>
<DIV><A id=ctl00_MemberMenu_MyMessages 
href="http://www.codeproject.com/script/Forums/Messages.aspx?fmid=7063922">My 
Messages</A></DIV>
<DIV><A id=ctl00_MemberMenu_MyQuestions 
href="http://www.codeproject.com/script/Answers/MemberPosts.aspx?tab=questions&amp;mid=7063922&amp;showall=True">My 
Questions</A></DIV>
<DIV><A id=ctl00_MemberMenu_MyAnswers 
href="http://www.codeproject.com/script/Answers/MemberPosts.aspx?tab=answers&amp;mid=7063922&amp;showall=True">My 
Answers</A></DIV></DIV></SPAN><SPAN style="MARGIN-LEFT: 0px" 
id=ctl00_MemberMenu_TotalPoints class="member-rep-box bronze" 
title="Total reputation points 377"><A 
href="http://www.codeproject.com/script/Reputation/List.aspx?mid=7063922">377</A></SPAN> 
&nbsp; <A id=ctl00_MemberMenu_Signout 
href="http://www.codeproject.com/script/Membership/LogOff.aspx?rp=%2fKB%2fshell%2fOpenedFileFinder.aspx">Sign 
out</A> </DIV></DIV>
<TABLE border=0 cellSpacing=0 cellPadding=0 width="100%">
  <TBODY>
  <TR>
    <TD class=header><A href="http://www.codeproject.com/"><IMG 
      style="BORDER-RIGHT-WIDTH: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px" 
      id=ctl00_Logo title="The Code Project" alt=Home 
      src="Listing%20Used%20Files%20-%20CodeProject_files/logo225x90.gif"></A></TD>
    <TD class=header align=right>
      <DIV class=lqm_ad lqm_tags="VC6,Windows,Dev,Intermediate" lqm_country="CN" 
      lqm_format="8" lqm_zone="77" lqm_publisher="495" lqm_channel="1" 
      height="90px" width="728px"></DIV></TD></TR></TBODY></TABLE>
<TABLE class="contrast1-background extended" cellSpacing=0 cellPadding=0>
  <TBODY>
  <TR>
    <TD noWrap>
      <DIV class="navbar clearfix">
      <UL id=nav>
        <LI><A id=ctl00_TopNavBar_Home class=down 
        href="http://www.codeproject.com/">Home</A> </LI>
        <LI><A id=ctl00_TopNavBar_Art class="down selected" 
        href="http://www.codeproject.com/script/Articles/Latest.aspx">Articles</A> 

        <UL>
          <LI><A id=ctl00_TopNavBar_ArtTopicList class="fly last" 
          onmouseover="ShowMap(this, 'siteMap');" 
          href="http://www.codeproject.com/script/Content/SiteMap.aspx">Chapters 
          and Sections</A>
          <UL id=ctl00_TopNavBar_MapFlyout>
            <LI>
            <DIV id=siteMap class=tooltip-flyout><IMG 
            style="MARGIN: 150px; WIDTH: 100px; HEIGHT: 100px" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/animated.gif"> 
            </DIV></LI></UL></LI>
          <LI><A id=ctl00_TopNavBar_ArtSearch class="fly break" 
          href="http://www.codeproject.com/search.aspx">Search</A></LI>
          <LI><A id=ctl00_TopNavBar_ArtLatestArts class=fly 
          href="http://www.codeproject.com/script/Articles/Latest.aspx?at=1,3,7">Latest 
          Articles</A></LI>
          <LI><A id=ctl00_TopNavBar_ArtLatestTips class=fly 
          href="http://www.codeproject.com/script/Articles/Latest.aspx?at=6,8">Latest 
          Tips/Tricks</A></LI>
          <LI><A id=ctl00_TopNavBar_ArtTop class=fly 
          href="http://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=4">Top 
          Articles</A></LI>
          <LI><A id=ctl00_TopNavBar_ArtBeginner class=fly 
          href="http://www.codeproject.com/search.aspx?aidlst=152&amp;sa_us=True">Beginner 
          Articles</A></LI>
          <LI id=ctl00_TopNavBar_VideosLink><A 
          id=ctl00_TopNavBar_ArtVideoArticles class=fly 
          href="http://www.codeproject.com/script/Articles/VideoArticleList.aspx">Video 
          Articles</A> </LI>
          <LI><A id=ctl00_TopNavBar_ArtBlogArticles class="fly break" 
          href="http://www.codeproject.com/script/Articles/BlogArticleList.aspx">Technical 
          Blogs</A></LI>
          <LI><A id=ctl00_TopNavBar_ArtPostArticle class=fly 
          href="http://www.codeproject.com/script/Articles/Submit.aspx">Post an 
          Article</A></LI>
          <LI><A id=ctl00_TopNavBar_ArtPostTipTrick class=fly 
          href="http://www.codeproject.com/Tips/post.aspx">Post Tip &amp; 
          Trick</A></LI>
          <LI><A id=ctl00_TopNavBar_ArtPostBlog class="fly break" 
          href="http://www.codeproject.com/script/Articles/BlogFeed.aspx">Post 
          your Blog</A></LI>
          <LI><A id=ctl00_TopNavBar_ArtGuide class=fly 
          href="http://www.codeproject.com/info/Submit.aspx">Posting/Update 
          Guidelines</A></LI>
          <LI><A id=ctl00_TopNavBar_ArtCompetition class="fly last" 
          href="http://www.codeproject.com/script/Awards/CurrentCompetitions.aspx?cmpTpId=1">Article 
          Competition</A></LI></UL></LI>
        <LI><A id=ctl00_TopNavBar_Answers 
        href="http://www.codeproject.com/script/Answers/List.aspx?tab=active">Questions 
        &amp; Answers</A> 
        <UL>
          <LI id=ctl00_TopNavBar_AQL><A id=ctl00_TopNavBar_ArticleQuestion 
          class="fly highlight" 
          href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#_comments">Ask 
          a Question about this article</A></LI>
          <LI class=heading>Quick Answers</LI>
          <LI><A id=ctl00_TopNavBar_QAAsk class=fly 
          href="http://www.codeproject.com/Questions/ask.aspx">Ask a 
          Question</A></LI>
          <LI><A id=ctl00_TopNavBar_QAUnanswered class=fly 
          href="http://www.codeproject.com/script/Answers/List.aspx?tab=unanswered">View 
          Unanswered Questions</A></LI>
          <LI><A id=ctl00_TopNavBar_QALatest class=fly 
          href="http://www.codeproject.com/script/Answers/List.aspx?tab=active">View 
          All Questions...</A></LI>
          <LI><A style="PADDING-LEFT: 30px" id=ctl00_TopNavBar_QATR_ctl00_Tag 
          class=fly 
          href="http://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;tags=81">C# 
          questions</A></LI>
          <LI><A style="PADDING-LEFT: 30px" id=ctl00_TopNavBar_QATR_ctl01_Tag 
          class=fly 
          href="http://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;tags=85">ASP.NET 
          questions</A></LI>
          <LI><A style="PADDING-LEFT: 30px" id=ctl00_TopNavBar_QATR_ctl02_Tag 
          class=fly 
          href="http://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;tags=842">VB.NET 
          questions</A></LI>
          <LI><A style="PADDING-LEFT: 30px" id=ctl00_TopNavBar_QATR_ctl03_Tag 
          class=fly 
          href="http://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;tags=78">C++ 
          questions</A></LI>
          <LI><A style="PADDING-LEFT: 30px" id=ctl00_TopNavBar_QATR_ctl04_Tag 
          class=fly 
          href="http://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;tags=69">C#3.0 
          questions</A></LI>
          <LI class=heading>Programming Discussions</LI>
          <LI><A id=ctl00_TopNavBar_MessageBoardsAll class=fly 
          href="http://www.codeproject.com/script/Forums/List.aspx">All Message 
          Boards...</A></LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1580997/Application-Lifecycle.aspx">Application 
          Lifecycle<SPAN class=fly-menu>&gt;</SPAN></A> 
          <UL>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/369270/Design-and-Architecture.aspx">Design 
            and Architecture</A></LI>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/1533717/Running-a-Business.aspx">Running 
            a Business</A></LI>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/1533716/Sales-Marketing.aspx">Sales 
            / Marketing</A></LI>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/1651/Collaboration-Beta-Testing.aspx">Collaboration 
            / Beta Testing</A></LI>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/3304/Work-Training-Issues.aspx">Work 
            &amp; Training Issues</A></LI></UL></LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1627782/Free-Tools.aspx">Free 
          Tools</A> </LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/12076/ASP-NET.aspx">ASP.NET</A> 
          </LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1580226/JavaScript.aspx">JavaScript</A> 
          </LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1647/C-Cplusplus-MFC.aspx">C / 
          C++ / MFC<SPAN class=fly-menu>&gt;</SPAN></A> 
          <UL>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/4486/ATL-WTL-STL.aspx">ATL / 
            WTL / STL</A></LI>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed 
            C++/CLI</A></LI></UL></LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1649/Csharp.aspx">C#</A> </LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1725/Database.aspx">Database</A> 
          </LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/186301/Hardware-Devices.aspx">Hardware 
          &amp; Devices<SPAN class=fly-menu>&gt;</SPAN></A> 
          <UL>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/1644/System-Admin.aspx">System 
            Admin</A></LI></UL></LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1606152/Hosting-and-Servers.aspx">Hosting 
          and Servers</A> </LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1643/Java.aspx">Java</A> </LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1650/NET-Framework.aspx">.NET 
          Framework</A> </LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/13695/Mobile.aspx">Mobile</A> 
          </LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1540733/Sharepoint.aspx">Sharepoint</A> 
          </LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1004257/Silverlight-WPF.aspx">Silverlight 
          / WPF</A> </LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1646/Visual-Basic.aspx">Visual 
          Basic</A> </LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1640/Web-Development.aspx">Web 
          Development<SPAN class=fly-menu>&gt;</SPAN></A> 
          <UL>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/1580227/CSS.aspx">CSS</A></LI>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/1213656/PHP.aspx">PHP</A></LI></UL></LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1645/Site-Bugs-Suggestions.aspx">Site 
          Bugs / Suggestions</A> </LI>
          <LI class=heading>Other Languages<SPAN class=fly-menu>&gt;</SPAN> 
          <UL>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/1580229/Hindi.aspx">General 
            Indian Topics</A></LI>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/1580230/Chinese.aspx">General 
            Chinese Topics</A></LI></UL></LI></UL></LI>
        <LI><A id=ctl00_TopNavBar_Zones 
        href="http://www.codeproject.com/Zones/index.aspx">Learning Zones</A> 
        <UL><!--<li class="heading">Zones</li>-->
          <LI><A class=fly href="http://www.codeproject.com/Zones/Commerce/">The 
          Commerce Zone</A></LI>
          <LI><A class=fly href="http://www.codeproject.com/Zones/Mobile/">The 
          Mobile Zone</A></LI>
          <LI><A class=fly href="http://www.codeproject.com/Zones/Cloud/">The 
          Cloud Zone</A></LI>
          <LI><A class=fly href="http://www.codeproject.com/Zones/Hardware/">The 
          Hardware Zone</A></LI>
          <LI><A class=fly 
          href="http://www.codeproject.com/Zones/Parallelism/">The Parallelism 
          Zone</A></LI>
          <LI><A class=fly 
          href="http://www.codeproject.com/Zones/WPF-Silverlight/">The WPF / 
          Silverlight Zone</A></LI>
          <LI><A class=fly 
          href="http://www.codeproject.com/Zones/Flex-Flash/">The Flex / Flash 
          Zone</A></LI>
          <LI><A class=fly 
          href="http://www.codeproject.com/Zones/SqlServer/">The SQL 
          Zone</A></LI>
          <LI><A class="fly break" 
          href="http://www.codeproject.com/Zones/WhitePapers/">WhitePapers / 
          Webcasts</A></LI>
          <LI><A id=ctl00_TopNavBar_Solutions class="fly last" 
          href="http://www.codeproject.com/kb/Solution-Center/">Solutions 
          Center</A></LI></UL></LI>
        <LI><A id=ctl00_TopNavBar_Features 
        href="http://www.codeproject.com/Feature/">Features</A> 
        <UL>
          <LI><A id=ctl00_TopNavBar_WhosWho class=fly 
          href="http://www.codeproject.com/script/Membership/Profiles.aspx">Who's 
          Who</A></LI>
          <LI><A id=ctl00_TopNavBar_MVPs class=fly 
          href="http://www.codeproject.com/script/Awards/MVPWinners.aspx">CodeProject 
          MVPs</A></LI>
          <LI><A id=ctl00_TopNavBar_Companies class="fly break" 
          href="http://www.codeproject.com/script/Membership/Profiles.aspx?mgtid=1&amp;mgm=True">Company 
          Listings</A></LI>
          <LI><A id=ctl00_TopNavBar_Catalog class=fly 
          href="http://www.codeproject.com/script/Catalog/List.aspx">Component 
          &amp; Service Catalog</A></LI>
          <LI><A id=ctl00_TopNavBar_Comps class=fly 
          href="http://www.codeproject.com/script/Awards/CurrentCompetitions.aspx?cmpTpId=1&amp;awsac=true">Competitions</A></LI>
          <LI><A id=ctl00_TopNavBar_News class=fly 
          href="http://www.codeproject.com/script/News/List.aspx">News</A></LI>
          <LI><A id=ctl00_TopNavBar_Insider class=fly 
          href="http://www.codeproject.com/Feature/Insider/">Daily 
          Insider</A></LI>
          <LI><A id=ctl00_TopNavBar_Newsletters class=fly 
          href="http://www.codeproject.com/script/Mailouts/Archive.aspx?mtpid=1">Newsletter 
          archive</A></LI>
          <LI><A id=ctl00_TopNavBar_PressRelease class=fly 
          href="http://www.codeproject.com/script/PressReleases/Preview.aspx">Press 
          Releases</A></LI>
          <LI><A id=ctl00_TopNavBar_Surveys class=fly 
          href="http://www.codeproject.com/script/Surveys/List.aspx">Surveys</A></LI>
          <LI><A id=ctl00_TopNavBar_Stuff class=fly 
          href="http://www.codeproject.com/Info/Stuff.aspx">CodeProject 
          Stuff</A></LI>
          <LI><A id=ctl00_TopNavBar_AddIn class="fly last" 
          href="http://www.codeproject.com/Services/Addins/">CodeProject VS 
          Addin </A></LI></UL></LI>
        <LI><A id=ctl00_TopNavBar_Help 
        href="http://www.codeproject.com/KB/FAQs/">Help!</A> 
        <UL>
          <LI><A id=ctl00_TopNavBar_HelpWhatIs class=fly 
          href="http://www.codeproject.com/info/guide.aspx">What is 'The Code 
          Project'?</A></LI>
          <LI><A id=ctl00_TopNavBar_HelpGeneral class=fly 
          href="http://www.codeproject.com/KB/FAQs/">General FAQ</A></LI>
          <LI><A id=ctl00_TopNavBar_HelpPostQuestion class=fly 
          href="http://www.codeproject.com/Questions/ask.aspx">Post a 
          Question</A></LI>
          <LI><A id=ctl00_TopNavBar_HelpBugs class=fly 
          href="http://www.codeproject.com/Forums/1645/Site-Bugs-Suggestions.aspx">Bugs 
          and Suggestions</A></LI>
          <LI><A id=ctl00_TopNavBar_HelpSiteMap class=fly 
          href="http://www.codeproject.com/script/Content/SiteMap.aspx">Site 
          Directory</A></LI>
          <LI><A id=ctl00_TopNavBar_HelpAdvertise class=fly 
          href="http://www.codeproject.com/info/MediaKit.aspx">Advertise with 
          us</A></LI>
          <LI><A id=ctl00_TopNavBar_HelpAboutUs class="fly last" 
          href="http://www.codeproject.com/info/about.aspx">About 
        Us</A></LI></UL></LI>
        <LI style="MARGIN-LEFT: 10px"><A id=ctl00_TopNavBar_Lounge class=simple 
        href="http://www.codeproject.com/Lounge.aspx">The Lounge</A> 
        <UL>
          <LI><A id=ctl00_TopNavBar_LoungeLnk class=fly 
          href="http://www.codeproject.com/Lounge.aspx">The Lounge 
          &nbsp;</A></LI>
          <LI><A id=ctl00_TopNavBar_CleverLnk class=fly 
          href="http://www.codeproject.com/feature/CleverCode.aspx">Clever 
          Code</A></LI>
          <LI><A id=ctl00_TopNavBar_ShameLnk class=fly 
          href="http://www.codeproject.com/feature/HallOfSHame.aspx">Hall of 
          Shame</A></LI>
          <LI><A id=ctl00_TopNavBar_SoapBoxLnk class=fly 
          href="http://www.codeproject.com/Forums/1536756/The-Soapbox-2-0.aspx">The 
          Soapbox</A></LI></UL></LI></UL></DIV>
      <SCRIPT type=text/javascript>

function ShowMap(prnt, elmId) {
	var map = $('#' + elmId);
	
	if (!prnt.populated && !prnt.populating) {
		prnt.populating = true;
		map.css( { 'height': '400px', 'width': '400px' });
		map.load("/script/content/ajax/SiteMap.aspx", function() { prnt.populated = true; });
		prnt.populated = true;
		prnt.populating = false;
	}

	if (prnt.populated) {
		var width = Math.min((($(window).width()-map.offset().left) * 0.9), 1000);
		var height = Math.min((($(window).height()-map.offset().top) * 0.9), 700);
		map.css('width', width + 'px');
		map.css('height', height + 'px');
		map.css('overflow', 'auto');
		map.css('margin', '0');
	}
}

</SCRIPT>
    </TD>
    <TD align=right>
      <DIV class=search-bar>
      <FORM class=tight method=get name=Search action=/search.aspx><INPUT 
      id=sb_tb class="search " name=q> 
      <DIV class=hover-container>
      <DIV id=SearchFilter 
      class="search-advanced popup small-text align-left"><B>Search 
      within:<BR></B><INPUT id=sb_kw value=kw CHECKED type=radio name=sbo><LABEL 
      for=sb_kw>Articles</LABEL><BR><INPUT id=sb_qa value=qa type=radio 
      name=sbo><LABEL for=sb_qa>Quick Answers</LABEL><BR><INPUT id=sb_fm 
      value=fm type=radio name=sbo><LABEL for=sb_fm>Messages</LABEL><BR><INPUT 
      id=sb_ctlk value=ctlk type=radio name=sbo><LABEL for=sb_ctlk>Product 
      Catalog</LABEL><BR></DIV></DIV></FORM></DIV></TD></TR></TBODY></TABLE>
<DIV class="container-article hreview-aggregate">
<DIV class=container-header>
<DIV id=ctl00_Header class=header><A name=Main></A><A id=_articleTop 
name=_articleTop></A>
<DIV class="clearfix hover-container">
<DIV class=container>
<DIV class="breadcrumb float-left"><A 
href="http://www.codeproject.com/script/Content/SiteMap.aspx"><SPAN 
class=sitemap-anchor onmouseover="ShowMap(this,'map');"><IMG 
style="VERTICAL-ALIGN: middle" border=0 alt="Site map" 
src="Listing%20Used%20Files%20-%20CodeProject_files/sitemap16.png" width=16 
height=16>
<DIV id=map class=tooltip-flyout><IMG 
style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; MARGIN: 150px; WIDTH: 100px; HEIGHT: 100px; BORDER-TOP: 0px; BORDER-RIGHT: 0px" 
src="Listing%20Used%20Files%20-%20CodeProject_files/animated.gif"></DIV></SPAN></A>» 
<A href="http://www.codeproject.com/Chapters/1/Desktop-Development.aspx">Desktop 
Development</A> » <A href="http://www.codeproject.com/KB/shell/">Shell and IE 
programming</A> » <A 
href="http://www.codeproject.com/KB/shell/#General">General</A></DIV></DIV>
<DIV id=ctl00_TitleArea_InfoArea class=float-right>
<DIV class=infobox>
<TABLE class="tight small-text" cellSpacing=1 cellPadding=0>
  <TBODY>
  <TR>
    <TD>Licence&nbsp;</TD>
    <TD><A title="The Code Project Open License (CPOL)" 
      href="http://www.codeproject.com/info/cpol10.aspx">CPOL</A></TD></TR>
  <TR>
    <TD>First Posted&nbsp;</TD>
    <TD noWrap><B>28 May 2007</B></TD></TR>
  <TR>
    <TD>Views&nbsp;</TD>
    <TD><B>125,711</B></TD></TR>
  <TR>
    <TD>Downloads&nbsp;</TD>
    <TD><B>1,677</B></TD></TR>
  <TR>
    <TD>Bookmarked&nbsp;</TD>
    <TD><B>134 times</B></TD></TR></TBODY></TABLE></DIV></DIV>
<DIV class=item>
<H1 id=ctl00_TitleArea_ArticleTitle class=fn>Listing Used Files</H1></DIV>
<DIV class=author>By <B><A 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=1599046"><FONT 
color=#ff0000>N</FONT>aveen</A></B> | 29 Sep 2010 </DIV>
<DIV class=tags><SPAN id=ctl00_TitleArea_TagsList_TagWrp class=tags><SPAN 
id=ctl00_TitleArea_TagsList_VisibleTags><SPAN class=t><A 
href="http://www.codeproject.com/search.aspx?aidlst=4">VC6</A></SPAN><SPAN 
class=t><A 
href="http://www.codeproject.com/search.aspx?aidlst=94">Windows</A></SPAN><SPAN 
class=t><A 
href="http://www.codeproject.com/search.aspx?aidlst=118">Dev</A></SPAN><SPAN 
class=t><A 
href="http://www.codeproject.com/search.aspx?aidlst=153">Intermediate</A></SPAN></SPAN> 
</SPAN></DIV>
<DIV class="abstract summary"><SPAN id=ctl00_TitleArea_ArticleDescr>A 
ShellExtension that lists all the used files in a 
folder.</SPAN></DIV></DIV></DIV>
<DIV id=ctl00_HeadSide class=header-sidebar>
<DIV style="HEIGHT: 24px" class=align-left> </DIV>
<DIV class="bold pad-top">See Also</DIV>
<UL style="MARGIN-LEFT: 5px" class="outdent small-text">
  <LI><A id=ctl00_SeeAlso_LikeThis 
  href="http://www.codeproject.com/search.aspx?q=Listing+Used+Files">More like 
  this</A></LI>
  <LI><A id=ctl00_SeeAlso_ByAuthor 
  href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=1599046">More 
  by this author</A></LI></UL></DIV></DIV>
<DIV id=ctl00_Nav class=container-nav>
<DIV id=ctl00_TabContainer class="tabs-container clearfix">
<DIV class="float-right action-links"><A id=ctl00_ActionLinks_PrintLnk 
class=tooltip 
href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?display=Print"><IMG 
style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; VERTICAL-ALIGN: middle; BORDER-TOP: 0px; BORDER-RIGHT: 0px" 
src="Listing%20Used%20Files%20-%20CodeProject_files/print.gif" width=24 
height=24> 
<DIV class=speech-bubble-container-up>
<DIV class=speech-bubble-up>Print Article</DIV>
<DIV class=speech-bubble-pointer-up>
<DIV class=speech-bubble-pointer-up-inner></DIV></DIV></DIV></A><SPAN 
id=SBI><IMG style="VERTICAL-ALIGN: middle" id=ctl00_ActionLinks_AddTo_Img 
alt=add src="Listing%20Used%20Files%20-%20CodeProject_files/share_drop24.png" 
width=37 height=24> </SPAN>
<DIV id=ATD class=list-socialbookmark></DIV><SPAN class=tooltip><A 
style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; WIDTH: 24px; DISPLAY: inline-block; HEIGHT: 24px; VERTICAL-ALIGN: middle; BORDER-TOP: 0px; BORDER-RIGHT: 0px" 
id=ctl00_ActionLinks_ArticleBmk_ImgBt title=Bookmark 
onclick="return bookmarkMe(18975,2,'/script/Bookmarks/Ajax/Add.aspx?obid=18975&amp;obtid=2&amp;action=AddBookmark&amp;bio=true',true);" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=18975&amp;obtid=2&amp;action=AddBookmark&amp;bio=true" 
name=bm_18975_2 AlternateText="Bookmark"><IMG 
style="BORDER-RIGHT-WIDTH: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px" 
title=Bookmark alt="" 
src="Listing%20Used%20Files%20-%20CodeProject_files/bookmark.png"></A> <SPAN 
style="DISPLAY: none" id=ctl00_ActionLinks_ArticleBmk_StatusMsg class=tiny-text 
name="bm_18975_2"></SPAN>
<DIV class=speech-bubble-container-up>
<DIV class=speech-bubble-up>Add to your CodeProject bookmarks</DIV>
<DIV class=speech-bubble-pointer-up>
<DIV class=speech-bubble-pointer-up-inner></DIV></DIV></DIV></SPAN><A 
id=discussAnch class="tooltip anchorLink" 
href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#_comments"><IMG 
style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; VERTICAL-ALIGN: middle; BORDER-TOP: 0px; BORDER-RIGHT: 0px" 
alt=Discuss src="Listing%20Used%20Files%20-%20CodeProject_files/discuss.gif" 
width=24 height=24> 
<DIV class=speech-bubble-container-up>
<DIV class=speech-bubble-up>Discuss this article</DIV>
<DIV class=speech-bubble-pointer-up>
<DIV class=speech-bubble-pointer-up-inner></DIV></DIV></DIV></A><SPAN 
style="MARGIN-LEFT: -4px" id=ctl00_ActionLinks_cmtcnt 
class="subdue small-text align-middle">137</SPAN> </DIV>
<DIV class=float-left>
<DIV class="tabs float-left">
<TABLE cellSpacing=0 cellPadding=0>
  <TBODY>
  <TR>
    <TD class=tab-selected>Article</TD>
    <TD class=tab-unselected><A 
      href="http://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=18975">Browse 
      Code</A></TD>
    <TD class=tab-unselected><A 
      href="http://www.codeproject.com/script/Articles/Statistics.aspx?aid=18975">Stats</A></TD>
    <TD class=tab-unselected><A 
      href="http://www.codeproject.com/script/Articles/ListVersions.aspx?aid=18975">Revisions 
      (2)</A></TD></TR></TBODY></TABLE></DIV>
<DIV style="MARGIN-LEFT: 15px" class=float-left>
<DIV id=ctl00_CurRat class=tooltip name="CurRat_18975">
<TABLE class=small-text cellSpacing=0 cellPadding=0>
  <TBODY>
  <TR>
    <TD class=nowrap>
      <DIV style="POSITION: relative; WIDTH: 120px; HEIGHT: 24px" 
      class="nowrap rating-stars">
      <DIV style="WIDTH: 114px; HEIGHT: 24px" 
      class="clipped align-left float-left"><IMG 
      style="BORDER-RIGHT-WIDTH: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px" 
      src="Listing%20Used%20Files%20-%20CodeProject_files/stars-fill.png"> 
</DIV>
      <DIV style="POSITION: relative; WIDTH: 6px; HEIGHT: 24px" 
      class=clipped><IMG 
      style="POSITION: absolute; BORDER-RIGHT-WIDTH: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; TOP: 0px; RIGHT: 0px" 
      src="Listing%20Used%20Files%20-%20CodeProject_files/stars-empty.png"> 
      </DIV></DIV></TD>
    <TD id=ctl00_ArticleRating_VR class=nowrap>&nbsp;<SPAN 
      id=ctl00_ArticleRating_VotesR>&nbsp;<SPAN class=rating>4.76</SPAN> (<SPAN 
      class=count>66 votes</SPAN>)</SPAN> </TD></TR></TBODY></TABLE>
<DIV id=ctl00_RB class=speech-bubble-container-up>
<DIV style="WIDTH: 150px !important" class=speech-bubble-up>
<DIV>
<TABLE class=feature title="Voting Distribution. Recent data only" cellSpacing=0 
cellPadding=0>
  <TBODY>
  <TR>
    <TD class=chart-column><IMG title="" border=0 alt="" 
      src="Listing%20Used%20Files%20-%20CodeProject_files/t.gif" width=16 
      height=1><BR><SPAN title="0 votes">1</SPAN></TD>
    <TD class=chart-column><IMG title="" border=0 alt="" 
      src="Listing%20Used%20Files%20-%20CodeProject_files/t.gif" width=16 
      height=1><BR><SPAN title="0 votes">2</SPAN></TD>
    <TD class=chart-column><IMG title="1 vote, 1.5%" border=0 
      alt="1 vote, 1.5%" 
      src="Listing%20Used%20Files%20-%20CodeProject_files/pollcol.gif" width=16 
      height=1><BR><SPAN title="1 vote">3</SPAN></TD>
    <TD class=chart-column><IMG title="10 votes, 15.2%" border=0 
      alt="10 votes, 15.2%" 
      src="Listing%20Used%20Files%20-%20CodeProject_files/pollcol.gif" width=16 
      height=9><BR><SPAN title="10 votes">4</SPAN></TD>
    <TD class=chart-column><IMG title="55 votes, 83.3%" border=0 
      alt="55 votes, 83.3%" 
      src="Listing%20Used%20Files%20-%20CodeProject_files/pollcol.gif" width=16 
      height=50><BR><SPAN title="55 votes">5</SPAN></TD></TR></TBODY></TABLE>
<DIV class="small-text align-center">4.76/5 - 66 votes</DIV></DIV></DIV>
<DIV class=speech-bubble-pointer-up>
<DIV 
class=speech-bubble-pointer-up-inner></DIV></DIV></DIV></DIV></DIV></DIV></DIV>
<DIV id=ctl00_HeadSideFoot class=tabs-sidebar>
<DIV>Sponsored Links</DIV></DIV></DIV>
<DIV class=container-text>
<DIV id=AT class=text>
<DIV 
style="PADDING-BOTTOM: 10px; MARGIN: 20px; PADDING-LEFT: 10px; PADDING-RIGHT: 10px; PADDING-TOP: 10px" 
id=ctl00_confirmError class="Callout small-text"><IMG 
style="FLOAT: left; MARGIN-RIGHT: 10px" 
src="Listing%20Used%20Files%20-%20CodeProject_files/warning_32.png" width=32 
height=32><B>Is your email address OK?</B> You are signed up for our newsletters 
but your email address is either unconfirmed, or has not been reconfirmed in a 
long time. Please click <A id=ctl00_RequestConfirmLink2 
href="http://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fKB%2fshell%2fOpenedFileFinder.aspx">here</A> 
to have a confirmation email sent so we can confirm your email address and start 
sending you newsletters again. Alternatively, you can <A id=ctl00_SubscribeLink2 
href="http://www.codeproject.com/script/Membership/Subscribe.aspx?rp=%2fKB%2fshell%2fOpenedFileFinder.aspx">update 
your subscriptions</A>.</DIV>
<FORM 
style="PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: 0px; PADDING-TOP: 0px" 
id=aspnetForm method=post name=aspnetForm 
action=/KB/shell/OpenedFileFinder.aspx>
<DIV><INPUT id=__VIEWSTATE 
value=/wEPDwUKMjExOTQzNjk4Mw9kFgJmD2QWAgIFD2QWCAIRD2QWAgIBD2QWBmYPDxYCHgtOYXZpZ2F0ZVVybAUyL3NjcmlwdC9BcnRpY2xlcy9BZG1pbi9FZGl0b3JDaG9pY2UuYXNweD9haWQ9MTg5NzVkZAICDw8WAh8ABTgvc2NyaXB0L0F3YXJkcy9BZG1pbi9Bd2FyZE9iamVjdC5hc3B4P29iaWQ9MTg5NzUmb2J0aWQ9MmRkAgoPDxYCHwAFLy9zY3JpcHQvQXJ0aWNsZXMvQWRtaW4vUXVldWVFZGl0LmFzcHg/YWlkPTE4OTc1ZGQCEw9kFgICAQ9kFgICAQ9kFgZmDw8WAh8ABS0vS0Ivc2hlbGwvT3BlbmVkRmlsZUZpbmRlci5hc3B4P2Rpc3BsYXk9UHJpbnRkZAIEDxYCHglpbm5lcmh0bWwFAzEzN2QCBQ8PFgIfAAUmL3NjcmlwdC9BcnRpY2xlcy9SZXBvcnQuYXNweD9haWQ9MTg5NzVkZAIVD2QWAgIND2QWCAIBDxYCHgdWaXNpYmxlZxYEAgEPDxYCHwAFUy9zY3JpcHQvTWVtYmVyc2hpcC9TZW5kQ29uZmlybVJlcXVlc3QuYXNweD9ycD0lMmZLQiUyZnNoZWxsJTJmT3BlbmVkRmlsZUZpbmRlci5hc3B4ZGQCAw8PFgIfAAVKL3NjcmlwdC9NZW1iZXJzaGlwL1N1YnNjcmliZS5hc3B4P3JwPSUyZktCJTJmc2hlbGwlMmZPcGVuZWRGaWxlRmluZGVyLmFzcHhkZAICDxYCHgZhY3Rpb24FHy9LQi9zaGVsbC9PcGVuZWRGaWxlRmluZGVyLmFzcHgWCAIBD2QWAgIBDxYCHwJoZAIDD2QWAgICD2QWAgIBDxBkZBYAZAIJDxYCHgtfIUl0ZW1Db3VudAIBZAILD2QWAgIBDxYCHgRUZXh0BUY8YSAgaHJlZj0iL0tCL3NoZWxsL09wZW5lZEZpbGVGaW5kZXIuYXNweCNfYXJ0aWNsZVRvcCI+QXJ0aWNsZSBUb3A8L2E+ZAIKDw8WBB8FBQlQZXJtYWxpbmsfAAUfL0tCL3NoZWxsL09wZW5lZEZpbGVGaW5kZXIuYXNweGRkAhgPFgIfBQU4Q29weXJpZ2h0IDIwMDcgYnkgPGZvbnQgY29sb3I9IjB4RkYwMDAwMDAiPk48L2ZvbnQ+YXZlZW5kAhcPZBYCAgUPDxYCHwJoZGRkR3SVzNdOUbqXuSckkXUVMIFM3FU= 
type=hidden name=__VIEWSTATE> </DIV>
<DIV><INPUT id=__EVENTVALIDATION 
value=/wEWCALRxLzjCALAlMXDBwLBlMXDBwLClMXDBwLDlMXDBwLElMXDBwLP+++tCwK5upDkC59mPQHvv4PZGZ9A832FYZpNI1cj 
type=hidden name=__EVENTVALIDATION> </DIV><!-- Article Text Start -->
<DIV id=contentdiv><!-- Article Starts -->
<UL class=download>
  <LI><A 
  href="http://www.codeproject.com/KB/shell/OpenedFileFinder/OpenedFileFinder_Binary32.zip">Download 
  32 bit project demo - 305 KB</A></LI>
  <LI><A 
  href="http://www.codeproject.com/KB/shell/OpenedFileFinder/OpenedFileFinder_Binary64.zip">Download 
  64 bit project demo - 342 KB</A></LI>
  <LI><A 
  href="http://www.codeproject.com/KB/shell/OpenedFileFinder/OpenedFileFinder_src_vc6.zip">Download 
  VC 6 source - 141 KB</A></LI>
  <LI><A 
  href="http://www.codeproject.com/KB/shell/OpenedFileFinder/OpenFileFinder_src_vc8.zip">Download 
  VC 8 source - 306 KB</A></LI></UL>
<P class=small-text>[The VC6 version of source code is kept just for reference 
in case if any one is still using VC6. Also, it does not include any 
modifications done after <STRONG>June-06-2008</STRONG> mentioned in the Revision 
History section.]</P>
<P><IMG alt="Screenshot - Application.jpg" 
src="Listing%20Used%20Files%20-%20CodeProject_files/Application.jpg" width=606 
height=269 complete="true"></P>
<H2>Introduction</H2>
<P>This is a utility to display all the files that are opened under a specific 
folder.</P>
<H2>Background</H2>
<P>It often happens to me that when I try to rename or delete my current working 
folder of a project, it gives an error message like "Cannot rename BlaBlaBla: It 
is being used by another person or program". Almost at all times, I fail to find 
this other program/person, and end up restarting the machine. Since then, I have 
been searching for a method to find the list of files that an application uses. 
Even though the <CODE>ProcessExplorer</CODE> of <A 
href="http://www.microsoft.com/technet/sysinternals/ProcessesAndThreads/ProcessExplorer.mspx">SysInternals</A> 
lists the files opened by each process, it is hard to find opened files in a 
particular folder. So I created one that does this, purely because of my 
necessity.</P>
<H2>Using the Code</H2>
<P>Download the application and register it using RegSvr32 (<EM>RegSvr32 
OpenedFiles.dll)</EM>. This application basically contains two components: an 
extension DLL and a driver. The extension DLL is responsible for showing the 
context menu in the shell and the GUI you see. I will explain the role of the 
driver later in this article.</P>
<P>This application will install a menu on folders, the background of a folder, 
and on a drive. I suggest you read <A 
href="http://www.codeproject.com/KB/shell/shellextguide1.aspx">The Complete 
Idiot's Guide to Writing Shell Extensions - Part I</A>, article by Michael Dunn, 
if you are new to shell extensions. In fact, it was from there that I learned to 
write shell extensions.</P>
<P><IMG alt="Screenshot - context_menu.jpg" 
src="Listing%20Used%20Files%20-%20CodeProject_files/context_menu.jpg" width=365 
height=305 complete="true"></P>
<H3>Enumerating Opened Files</H3>
<P>When you click on the "List Opened Files" menu, it will first enumerate all 
of the opened files in the system. This is implemented in the following 
function:</P><PRE lang=C++><SPAN class=code-keyword>void</SPAN> EnumerateOpenedFiles( CString&amp; csPath, OF_CALLBACL CallBackProc, UINT_PTR pUserContext, 
                           HANDLE hDriver, 
                           GetFinalPathNameByHandleDef pGetFinalPathNameByHandle ) 

{
    ...............
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Get the list of all handles in the system
</SPAN>    PSYSTEM_HANDLE_INFORMATION pSysHandleInformation = <SPAN class=code-keyword>new</SPAN> SYSTEM_HANDLE_INFORMATION;
    DWORD size = <SPAN class=code-keyword>sizeof</SPAN>(SYSTEM_HANDLE_INFORMATION);
    DWORD needed = <SPAN class=code-digit>0</SPAN>;
    NTSTATUS status = NtQuerySystemInformation( SystemHandleInformation, 
                      pSysHandleInformation, size, &amp;needed );
    <SPAN class=code-keyword>if</SPAN>( !NT_SUCCESS(status))
    {
        <SPAN class=code-keyword>if</SPAN>( <SPAN class=code-digit>0</SPAN> == needed )
        {
            <SPAN class=code-keyword>return</SPAN>;<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> some other error
</SPAN>        }
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> The previously supplied buffer wasn't enough.
</SPAN>        <SPAN class=code-keyword>delete</SPAN> pSysHandleInformation;
        size = needed + <SPAN class=code-digit>1024</SPAN>;
        pSysHandleInformation = (PSYSTEM_HANDLE_INFORMATION)<SPAN class=code-keyword>new</SPAN> BYTE[size];
        status = NtQuerySystemInformation( SystemHandleInformation, 
                                           pSysHandleInformation, size, &amp;needed );
        <SPAN class=code-keyword>if</SPAN>( !NT_SUCCESS(status))
        {
            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> some other error so quit.
</SPAN>            <SPAN class=code-keyword>delete</SPAN> pSysHandleInformation;
            <SPAN class=code-keyword>return</SPAN>;
        }
    }
    .....................
    .....................
    .....................
        <SPAN class=code-keyword>for</SPAN> ( DWORD i = <SPAN class=code-digit>0</SPAN>; i <SPAN class=code-keyword>&lt;</SPAN> pSysHandleInformation-<SPAN class=code-keyword>&gt;</SPAN>dwCount; i++ )
    {
        SYSTEM_HANDLE&amp; sh = pSysHandleInformation-<SPAN class=code-keyword>&gt;</SPAN>Handles[i];
        <SPAN class=code-keyword>if</SPAN>( sh.bObjectType != nFileType )<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Under windows XP file handle is of type 28
</SPAN>        {
            <SPAN class=code-keyword>continue</SPAN>;
        }

        CString csFileName;
        CString csDir;
        <SPAN class=code-keyword>if</SPAN>( hDriver )
        {
            HANDLE_INFO stHandle = {<SPAN class=code-digit>0</SPAN>};
            ADDRESS_INFO stAddress;
            stAddress.pAddress = sh.pAddress;
            DWORD dwReturn = <SPAN class=code-digit>0</SPAN>;
            BOOL bSuccess = DeviceIoControl( hDriver, IOCTL_LISTDRV_BUFFERED_IO, 
                                             &amp;stAddress, <SPAN class=code-keyword>sizeof</SPAN>(ADDRESS_INFO), 
                                             &amp;stHandle, 
                                             <SPAN class=code-keyword>sizeof</SPAN>(HANDLE_INFO), &amp;dwReturn, NULL );

            
            <SPAN class=code-keyword>if</SPAN>( bSuccess &amp;&amp; stHandle.tcFileName[<SPAN class=code-digit>0</SPAN>] != <SPAN class=code-digit>0</SPAN> &amp;&amp; 
                stHandle.uType != FILE_DEVICE_SOUND &amp;&amp; 
                stHandle.uType != FILE_DEVICE_NAMED_PIPE )
            {

                <SPAN class=code-keyword>if</SPAN>( stHandle.uType != FILE_DEVICE_NETWORK_FILE_SYSTEM  )
                {
                    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Get the drive name from the dos device name
</SPAN>                    <SPAN class=code-keyword>if</SPAN>( !GetDrive( (LPCTSTR)stHandle.tcDeviceName, csFileName, <SPAN class=code-keyword>true</SPAN> ))
                    {
                        OutputDebugString( L<SPAN class=code-string>"</SPAN><SPAN class=code-string>GetDrive failed"</SPAN> );
                    }
                    csFileName += (LPCTSTR)stHandle.tcFileName;
                }
                <SPAN class=code-keyword>else</SPAN>
                {
                    csFileName = _T(<SPAN class=code-string>"</SPAN><SPAN class=code-string>\\"</SPAN>);
                    csFileName += (LPCTSTR)stHandle.tcFileName;
                }
            }
        }    
        ...
        </PRE>
<P>For every file opened in the system, there will be a handle associated with 
it. With the <CODE>NtQuerySystemInformation</CODE> API, we can retrieve all the 
handles in the system. This includes file handles, Mutex handles, Event handles, 
etc. Actually, the <CODE>NtQuerySystemInformation</CODE> function returns an 
array of the structure <CODE>SYSTEM_HANDLE</CODE>.</P><PRE lang=C++><SPAN class=code-keyword>typedef</SPAN> <SPAN class=code-keyword>struct</SPAN> _SYSTEM_HANDLE
{
    DWORD    dwProcessId;
    BYTE     bObjectType;
    BYTE     bFlags;
    WORD     wValue;
    PVOID    pAddress;
    DWORD    GrantedAccess;
}
SYSTEM_HANDLE;</PRE>
<P>For an object of type file, the value <CODE>bObjectType</CODE> in 
<CODE>SYSTEM_HANDLE</CODE> is 28 in Windows XP, Windows 2000, and Window 7; 25 
in Windows Vista; and 26 in Windows 2000. Since this application supports only 
XP/Windows 7, Windows 2000, and Vista, we can ignore all the items with values 
other than 28/25. In <CODE>SYSTEM_HANDLE</CODE>, there is another important 
member for us, the <CODE>pAddress</CODE>. For each file handle, there is a 
<CODE>FILE_OBJECT</CODE> associated with it, and the <CODE>pAddress</CODE> is a 
pointer to that structure. Unfortunately, this address points to kernel memory 
space, and a user mode application cannot access this memory. Here comes the 
driver part. This application accesses this memory using the driver 
"<EM>ListOpenedFileDrv_XX.sys</EM>". The only thing the driver does is copy the 
file name in the kernel memory and pass it to the user mode. Using the function 
<CODE>DeviceIoControl</CODE>, the <CODE>pAddress</CODE> is passed to the driver. 
The driver accepts this address and copies the file name from 
<CODE>FILE_OBJECT</CODE>, setting it in the <CODE>out</CODE> parameter of the 
<CODE>DeviceIoControl</CODE> function.</P>
<P>As I mentioned earlier, the Process Explorer shows the information about all 
the handles used by the application. However, the Process Explorer is a 
stand-alone application. So where is the driver? Or is it doing all this without 
the driver? This question puzzled me for many days until someone told me that 
the driver is added in the resource of the Process Explorer. Nice trick, isn't 
it? So I thought of implementing the same feature in my application too. The 
function given below performs this task. [Note: The new version of the 
application is not keeping the driver in the resource, but it directly uses the 
driver from the application folder. The below code is kept only for those who 
refer to the VC6 version of the source code.]</P><PRE lang=C++>HANDLE ExtractAndInstallDrv()
{
    SC_HANDLE hSCManager =
        OpenSCManager( NULL, NULL, SC_MANAGER_ALL_ACCESS );
    SC_HANDLE hService = OpenService
        ( hSCManager , DRV_NAME, SERVICE_ALL_ACCESS);
    CString csPath;
    <SPAN class=code-keyword>if</SPAN>( <SPAN class=code-digit>0</SPAN> == hService )
    {
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Service not installed. So install the service.
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> First extract the resource
</SPAN>        HINSTANCE hModule= AfxGetInstanceHandle();
        HRSRC hRsrc = FindResource
            (hModule, MAKEINTRESOURCE(IDR_XPDRIVER),_T(<SPAN class=code-string>"</SPAN><SPAN class=code-string>BINARY"</SPAN>));
        HGLOBAL hDrvRsrc = LoadResource(hModule, hRsrc);
        DWORD dwDriverSize = SizeofResource(hModule, hRsrc);
        LPVOID lpvDriver = LockResource(hDrvRsrc);
        CFile File;
        <SPAN class=code-keyword>if</SPAN>( !File.Open( DRV_FILE_NAME, CFile::modeCreate|CFile::modeWrite ))
        {
            <SPAN class=code-keyword>return</SPAN> <SPAN class=code-digit>0</SPAN>;
        }
        File.Write( lpvDriver, dwDriverSize );
        csPath = File.GetFilePath();
        File.Close();
        ...
    }</PRE>
<P>I made an application that does the above things and started using it. Some 
days later, again that rename problem occurred, and my application listed 
nothing. When I looked in the Task Manager, I found out that this time it was 
because of the applications that were running from my folder. So my next step 
was to enumerate the EXEs and any DLLs that have been loaded from my folder.</P>
<H3>Enumerating Loaded Modules</H3>
<P>Enumerating the modules loaded by applications was somewhat easy compared to 
the above task. It just made use of the following APIs. The 
<CODE>EnumerateLoadedModules</CODE> function handles this task in the 
application.</P><PRE lang=C++>EnumProcesses()
CreateToolhelp32Snapshot()
Module32First()
Module32Next()</PRE>
<H3>Compatibility with UAC</H3>
<P>As you have seen, this application makes use of many API calls that need 
Administrative privilege. But the <EM>Explorer.exe</EM> in Vista and later runs 
with restricted privilege so that the shell extension loaded by the explorer 
also cannot make any API calls that need Administrative privilege. Which means 
my current implementation, which had only one DLL that does all the job, is no 
longer going to work. So the only way is to spool another EXE from the shell 
extension in Administrative mode. So now, when you click on "List Opened Files", 
it launches <EM>OpenFileFinder.exe</EM> using <CODE>ShellExecute</CODE>, and the 
rest of the things are taken care by this process. But I was so lazy to move all 
the existing feature of in the shell extension DLL to the exe or another DLL. So 
what I did is I kept the functionality in the DLL itself and exported the 
function <CODE>ShowOpenedFiles</CODE> from the DLL, which when called, shows the 
opened files dialog. The diagram below show this architecture:</P>
<P><IMG alt="Screenshot - Application.jpg" 
src="Listing%20Used%20Files%20-%20CodeProject_files/Architecture.jpg" width=521 
height=200 complete="true"></P>
<H3>The Problem with Vista 64 Bit and Windows-7 64 Bit</H3>
<P>In 64 bit versions of Windows, starting from Vista, Microsoft has enforced 
that any program that is supposed to be loaded into the kernel space should be 
digitally signed by Microsoft. This enforcement affect lots of free software and 
unfortunately to this software also. The core thing in this application is done 
by our tiny driver which I no longer will be able to load in those versions of 
Windows. So my initial plan was to discontinue this application in 64 bit Vista 
and later. However, because of the new APIs which are introduced from Windows 
Vista, there is still an option to make this work without the driver also. So 
this application still works in 64 bit Vista and Windows with limited results. 
The new API that I was talking about is <A 
href="http://msdn.microsoft.com/en-us/library/aa364962(VS.85).aspx"><CODE>GetFinalPathNameByHandle</CODE></A>. 
However, using the API instead of our driver has some problems like:</P>
<UL>
  <LI>This function accepts <CODE>HANDLE</CODE>, but the handles are not unique 
  among all processes.</LI>
  <LI>To solve the above problem, we have to duplicate the handle. To duplicate 
  the handle, I have to get the process handle using <CODE>OpenProcess</CODE>. 
  But <CODE>OpenProcess</CODE> fails for some processes like SYSTEM because of 
  lack of access. Even if we successfully duplicate some other handles, the API 
  still fails saying Access Denied.</LI>
  <LI>Last and the worst, it hangs for certain kinds of handles. You can read 
  mode about this problem in here: <A 
  href="http://0memory.blogspot.com/2008/08/getfinalpathnamebyhandle-api-hungs.html">GetFinalPathNameByHandle 
  API Hungs</A>. At the time when I was checking this problem in Windows Vista, 
  I remember atleast the <A 
  href="http://msdn.microsoft.com/en-us/library/aa364953(VS.85).aspx"><CODE>GetFileInformationByHandleEx</CODE></A> 
  worked in all cases. But now I experience the same problem in Windows 
7.</LI></UL>
<P>The only workaround to prevent the entire application from hanging is to call 
the API from a separate thread. So what I did in this application is, if the 
driver installation fails, it will switch to Plan B, which is actually to use 
the <CODE>GetFinalPathNameByHandle</CODE> in a separate thread. Meanwhile, the 
main thread will keep on checking whether the worker thread has hung or not 
using some events. After a time out period, if the main thread does not receive 
the event, it will terminate the worked thread and spool another worker thread. 
This is continued until all the the handles have been enumerated.</P>
<P>The following code shows how the API is called from the thread:</P><PRE lang=C++>DWORD WINAPI ThreadProc( LPVOID lParam )
{
    THREAD_PARAMS* pThreadParam = (THREAD_PARAMS*)lParam;    
    GetFinalPathNameByHandleDef pGetFinalPathNameByHandle = 
                       pThreadParam-<SPAN class=code-keyword>&gt;</SPAN>pGetFinalPathNameByHandle;
    <SPAN class=code-keyword>for</SPAN>( g_CurrentIndex; g_CurrentIndex <SPAN class=code-keyword>&lt;</SPAN> pThreadParam-<SPAN class=code-keyword>&gt;</SPAN>pSysHandleInformation-<SPAN class=code-keyword>&gt;</SPAN>dwCount;  )
    {
        WaitForSingleObject( pThreadParam-<SPAN class=code-keyword>&gt;</SPAN>hStartEvent, INFINITE );
        ResetEvent( pThreadParam-<SPAN class=code-keyword>&gt;</SPAN>hStartEvent ). 
        pThreadParam-<SPAN class=code-keyword>&gt;</SPAN>bStatus = <SPAN class=code-keyword>false</SPAN>;
        SYSTEM_HANDLE&amp; sh = pThreadParam-<SPAN class=code-keyword>&gt;</SPAN>pSysHandleInformation-<SPAN class=code-keyword>&gt;</SPAN>Handles[g_CurrentIndex];
        g_CurrentIndex++;
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> First try to duplicate the handle,
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> if the duplicate handle failed, we will coninue with the
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> original handle. But calling the API
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> with the orginal handle is least likly to success
</SPAN>        HANDLE hDup = (HANDLE)sh.wValue;
        HANDLE hProcess = OpenProcess( PROCESS_DUP_HANDLE , FALSE, sh.dwProcessId );
        <SPAN class=code-keyword>if</SPAN>( hProcess )
        {
            BOOL b = DuplicateHandle( hProcess, (HANDLE)sh.wValue, 
                       GetCurrentProcess(), &amp;hDup, <SPAN class=code-digit>0</SPAN>, FALSE, DUPLICATE_SAME_ACCESS );
            <SPAN class=code-keyword>if</SPAN>( !b )
            {
                hDup = (HANDLE)sh.wValue;
            }
            CloseHandle( hProcess );
        }
        DWORD dwRet = pGetFinalPathNameByHandle( hDup, pThreadParam-<SPAN class=code-keyword>&gt;</SPAN>lpPath, MAX_PATH, <SPAN class=code-digit>0</SPAN> );
        <SPAN class=code-keyword>if</SPAN>( hDup &amp;&amp; (hDup != (HANDLE)sh.wValue))
        {
            CloseHandle( hDup );
        }
        <SPAN class=code-keyword>if</SPAN>(dwRet)
        {
            pThreadParam-<SPAN class=code-keyword>&gt;</SPAN>bStatus = <SPAN class=code-keyword>true</SPAN>;
        }
        SetEvent( pThreadParam-<SPAN class=code-keyword>&gt;</SPAN>hFinishedEvent );
        
    }
    <SPAN class=code-keyword>return</SPAN> <SPAN class=code-digit>0</SPAN>;
}</PRE>
<P>And this is how the main thread delegates its work to the thread 
procedure:</P><PRE lang=C++><SPAN class=code-keyword>void</SPAN> EnumerateOpenedFiles( CString&amp; csPath, OF_CALLBACL CallBackProc, 
                           UINT_PTR pUserContext, HANDLE hDriver,
                           GetFinalPathNameByHandleDef pGetFinalPathNameByHandle ) 
{
    ................
    ................
    <SPAN class=code-keyword>if</SPAN>( pGetFinalPathNameByHandle )<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> there is no driver, we have do it ugly way
</SPAN>    {
        g_CurrentIndex = <SPAN class=code-digit>0</SPAN>;
        TCHAR tcFileName[MAX_PATH+1];
        THREAD_PARAMS ThreadParams;
        ThreadParams.lpPath = tcFileName;
        ThreadParams.nFileType = nFileType;
        ThreadParams.pGetFinalPathNameByHandle = pGetFinalPathNameByHandle;
        ThreadParams.pSysHandleInformation = pSysHandleInformation;
        ThreadParams.hStartEvent = ::CreateEvent( <SPAN class=code-digit>0</SPAN>, TRUE, FALSE, <SPAN class=code-digit>0</SPAN> );
        ThreadParams.hFinishedEvent = ::CreateEvent( <SPAN class=code-digit>0</SPAN>, TRUE, FALSE, <SPAN class=code-digit>0</SPAN> );
        HANDLE ThreadHandle = <SPAN class=code-digit>0</SPAN>;
        <SPAN class=code-keyword>while</SPAN>( g_CurrentIndex <SPAN class=code-keyword>&lt;</SPAN> pSysHandleInformation-<SPAN class=code-keyword>&gt;</SPAN>dwCount )
        {
            <SPAN class=code-keyword>if</SPAN>( !ThreadHandle )
            {
                ThreadHandle = CreateThread( <SPAN class=code-digit>0</SPAN>, <SPAN class=code-digit>0</SPAN>, ThreadProc, &amp;ThreadParams, <SPAN class=code-digit>0</SPAN>, <SPAN class=code-digit>0</SPAN> );    
            }
            ResetEvent( ThreadParams.hFinishedEvent );
            SetEvent( ThreadParams.hStartEvent );
            <SPAN class=code-keyword>if</SPAN>( WAIT_TIMEOUT == WaitForSingleObject( ThreadParams.hFinishedEvent, <SPAN class=code-digit>100</SPAN> ))
            {
                CString csError;
                csError.Format(L<SPAN class=code-string>"</SPAN><SPAN class=code-string>Query hang for handle %d"</SPAN>, 
                   (<SPAN class=code-keyword>int</SPAN>)pSysHandleInformation-<SPAN class=code-keyword>&gt;</SPAN>Handles[g_CurrentIndex - <SPAN class=code-digit>1</SPAN>].wValue);
                OutputDebugString(csError );
                TerminateThread( ThreadHandle, <SPAN class=code-digit>0</SPAN> );
                CloseHandle( ThreadHandle );
                ThreadHandle = <SPAN class=code-digit>0</SPAN>;
                <SPAN class=code-keyword>continue</SPAN>;
            }
            <SPAN class=code-keyword>if</SPAN>( !ThreadParams.bStatus )
            {
                <SPAN class=code-keyword>continue</SPAN>;
            }
    ................
    ................
}</PRE>
<P>Compared to the driver method, this one is much slower and returns less 
results. You have to switch off the diver signature enforcement in 64 bit Vista 
if you still want this application to work using the driver.</P>
<H3>How Third Party Applications Can Make Use of This Application</H3>
<P>After the initial version of this application, I received many requests from 
people to export some functions so that other applications can also make use of 
this functionality. Starting from this release, <EM>OpenFileFinder.dll</EM> 
exports two C functions, which can be called from other binaries:</P>
<UL>
  <LI><CODE><SPAN class=code-keyword>void</SPAN> ShowOpenedFiles( LPCWSTR lpPath 
  )</CODE></LI>
  <P>You can call this function if you want to show the dialog and display the 
  opened files in it.</P>
  <LI><CODE><SPAN class=code-keyword>void</SPAN> GetOpenedFiles( LPCWSTR lpPath, 
  OF_TYPE Filter,OF_CALLBACK CallBackProc,UINT_PTR pUserContext );</CODE></LI>
  <P>If you call this function and pass a callback pointer, for each file handle 
  that matches the input path, the callback function will be called.</P></UL>
<P>The above functions plus the <CODE>OF_TYPE</CODE> enum and the 
<CODE>OF_CALLBACK</CODE> function pointer is defined in 
<EM>OpenedFiles.h</EM>.</P>
<H3>Close Handle Option</H3>
<P>During the initial development of this utility, I purposefully ignored the 
option for closing any file handles opened by another process. I though it was 
unsafe if it provides such an option because closing the handle may lead to 
unexpected results in that application. However, I later got into some 
situations like the folder I wanted to rename was used by <EM>service.exe</EM>. 
And if I wanted to rename the folder, the only option was to terminate the 
process. But terminating <EM>service.exe</EM> will make the entire system 
unstable. And so I was forced to include a Close Handle option too.</P>
<P>So how this option basically works is, it duplicates the handle using the 
<CODE>DuplicateHandle()</CODE> function with the 
<CODE>DUPLICATE_CLOSE_SOURCE</CODE> flag specified. After that, it closes the 
duplicate handle also using the <CODE>CloseHandle()</CODE> function. This option 
will work only for loaded files; i.e., using this option on a DLL used by 
another process is just ignored.</P><PRE lang=C++>HANDLE hDup = <SPAN class=code-digit>0</SPAN>;
BOOL b = DuplicateHandle( hProcess, hFile, GetCurrentProcess(), 
    &amp;hDup, DUPLICATE_SAME_ACCESS , FALSE, DUPLICATE_CLOSE_SOURCE );
<SPAN class=code-keyword>if</SPAN>( hDup )
{
    CloseHandle( hDup );
}
CloseHandle( hProcess );</PRE>
<P>Basically, with the above code, we can close the handles created by another 
process. After closing the handle, we can rename or delete that file or 
directory. But there are cases where after closing the handle, we can rename the 
folder but deleting is not possible. For example, consider the file 
<EM>C:\WINDOWS\system32\config\CstEvent.Evt</EM>. Normally, this file is used by 
<EM>Service.exe</EM> for event logging purposes. So if we try to close this file 
handle using the above option, the handle will be closed and we can rename too, 
but cannot delete!! I tried many ways to solve this, but couldn't come up with a 
working solution. If anybody knows any options to solve this, please let me 
know.</P>
<H3>Miscellaneous Features</H3>
<H4>Auto Complete in Combobox</H4>
<P><IMG alt="Screenshot - AutoComplete.jpg" 
src="Listing%20Used%20Files%20-%20CodeProject_files/AutoComplete.jpg" width=604 
height=270 complete="true"></P>
<P>You have probably noticed that when we type some paths in the Run dialog of 
Windows, it will list the files and folders under that path. Similarly, when you 
type a path in the combobox of this application, it will list the files and 
folders under that path. <CODE>SHAutoComplete</CODE> takes care of this feature. 
This function needs a handle of the edit control. But I only have a combobox - 
how do I take the edit control inside it? Well, the edit control inside the 
combobox has a control ID 1001. Use the <CODE>GetDlgItem()</CODE> function with 
this ID to get the handle of the edit control. You can also specify a filename 
in that combobox.</P><PRE lang=C++>BOOL MainDlg::OnInitDialog()
{
    .....
    CWnd* pEdit =  m_combobox.GetDlgItem( <SPAN class=code-digit>1001</SPAN> );
    <SPAN class=code-keyword>if</SPAN>( pEdit )
    {
        SHAutoComplete( pEdit-<SPAN class=code-keyword>&gt;</SPAN>m_hWnd, SHACF_FILESYSTEM );
    }
}</PRE>
<H4>Find Target Option</H4>
<P>When you right click on one item in the list control of this application, you 
will find a menu called "Find Target". This option is something like the Find 
Target option in Windows Explorer. It opens a Windows Explorer window with a 
specified file selected in its folder. <CODE>SHOpenFolderAndSelectItems()</CODE> 
is used for implementing this feature.</P><PRE lang=C++><SPAN class=code-keyword>void</SPAN> MainDlg::OnMainFindtarget()
{
    ....
    CString csPath;
    csPath = m_list.GetItemText( nItem,<SPAN class=code-digit>2</SPAN> );
    LPITEMIDLIST stId = <SPAN class=code-digit>0</SPAN>;
    SFGAOF stSFGAOFIn = <SPAN class=code-digit>0</SPAN>;
    SFGAOF stSFGAOFOut = <SPAN class=code-digit>0</SPAN>;
    <SPAN class=code-keyword>if</SPAN>( !FAILED(SHParseDisplayName( csPath, <SPAN class=code-digit>0</SPAN>, &amp;stId,stSFGAOFIn, &amp;stSFGAOFOut )))
    {
        SHOpenFolderAndSelectItems( stId, <SPAN class=code-digit>0</SPAN>, <SPAN class=code-digit>0</SPAN>, <SPAN class=code-digit>0</SPAN> );
    }
}</PRE>
<H4>Show Loaded Modules and Show Loaded Files - Options</H4>
<P>As mentioned above, the list control in the application list includes two 
types of items - loaded files and loaded modules (DLLs, OCX, EXE etc.). This 
option is to Show/Hide one type of item from the list.</P>
<H3>Note </H3>
<P>This application uses a driver built for Windows XP/Win2003/Vista/Window 7, 
and so it will run only on those versions. If you want, you can add support for 
other OS versions as well by building the driver and making the necessary 
changes to the application.</P>
<H2>Revision History</H2>
<H4>September-29-2010</H4>
<UL>
  <LI>Added 64 bit support</LI>
  <LI>Added modifications mentioned in the section "Compatibility with UAC"</LI>
  <LI>Added modifications mentioned in the section "The problem with Vista 64 
  bit and Windows-7 64 bit"</LI></UL>
<H4>June-06-2008</H4>
<UL>
  <LI>The bug described in the below <A 
  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?msg=2547364#xx2547364xx">post</A>[<A 
  title="New Window" 
  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?msg=2547364#xx2547364xx" 
  target=_blank>^</A>] has been fixed</LI>
  <LI>Close Handle and Close All Handle options added</LI>
  <LI>"Show Loaded Modules" and "Show Loaded Files" options added</LI></UL>
<H4>October-12-2007</H4>
<UL>
  <LI>Application icon is displayed along with process</LI>
  <LI>Miscellaneous Features section added</LI></UL>
<H4>September-27-2007</H4>
<UL>
  <LI>"Find Target" menu added</LI>
  <LI>Added driver for Windows Vista</LI>
  <LI>Added VC8 solution</LI></UL>
<H4>June-30-2007</H4>
<UL>
  <LI>Article moved</LI></UL>
<H4>June-4-2007</H4>
<UL>
  <LI>Article updated</LI></UL>
<H4>May-28-2007</H4>
<UL>
  <LI>Original version posted</LI></UL></DIV><!-- Article Text End -->
<H2>License</H2>
<DIV id=LicenseTerms>
<P>This article, along with any associated source code and files, is licensed 
under <A href="http://www.codeproject.com/info/cpol10.aspx" rel=license>The Code 
Project Open License (CPOL)</A></P></DIV>
<H2 id=ctl00_AboutHeading>About the Author</H2>
<DIV class=float-right>
<DIV class=lqm_ad lqm_tags="VC6,Windows,Dev,Intermediate" lqm_country="CN" 
lqm_format="6" lqm_zone="77" lqm_publisher="495" lqm_channel="1" height="250px" 
width="300px"></DIV></DIV>
<TABLE border=0 cellSpacing=5 cellPadding=0>
  <TBODY>
  <TR vAlign=top>
    <TD style="WIDTH: 155px" 
    id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhotoTable 
      vAlign=top><B><A 
      id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink 
      href="http://www.codeproject.com/script/Membership/View.aspx?mid=1599046"><FONT 
      color=#ff0000>N</FONT>aveen</A></B><BR><BR>
      <CENTER><IMG 
      style="BORDER-RIGHT-WIDTH: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px" 
      id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto 
      src="Listing%20Used%20Files%20-%20CodeProject_files/%257BD5771DE2-6D71-4D51-8ECC-532B2EA5068D%257D.jpg"></CENTER>
      <DIV class=small-text><SPAN 
      id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle>Software 
      Developer (Senior)</SPAN><BR><SPAN 
      id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany></SPAN><BR><SPAN 
      id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation><IMG alt=India 
      src="Listing%20Used%20Files%20-%20CodeProject_files/IN.gif" width=16 
      height=11> India</SPAN><BR><BR><SPAN 
      id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberType>Member</SPAN><BR></DIV></TD>
    <TD><BR></TD></TR></TBODY></TABLE><BR>
<DIV class=clearfix></DIV>
<DIV id=ctl00_RateArticleRow class="clearfix voting-bar">
<DIV style="PADDING-TOP: 8px" class=float-left><A 
href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#_articleTop">Article 
Top</A></DIV>
<DIV class="float-right align-right">
<DIV id=ctl00_RateArticle_RateItemWrapper class="container-rating small-text" 
name="RateItem_18975">
<TABLE class=small-text cellSpacing=0 cellPadding=0 width="100%">
  <TBODY>
  <TR>
    <TD id=ctl00_RateArticle_VoteResultDiv noWrap align=right><SPAN 
      class=voteRes></SPAN><IMG style="DISPLAY: none" class=loaderImg 
      alt=loading... 
      src="Listing%20Used%20Files%20-%20CodeProject_files/ajax-loader.gif" 
      width=16 height=16> </TD>
    <TD style="WHITE-SPACE: nowrap" class=voteTbl align=right>
      <TABLE class=small-text>
        <TBODY>
        <TR>
          <TD style="PADDING-RIGHT: 5px; WHITE-SPACE: nowrap" 
          id=ctl00_RateArticle_RateText><I><B>Rate this article for 
            us!</B></I> </TD>
          <TD id=ctl00_RateArticle_StartForm noWrap 
            align=right><I>&nbsp;&nbsp;Poor</I> </TD>
          <TD style="WHITE-SPACE: nowrap" id=ctl00_RateArticle_VoteFormDiv 
          align=left>
            <TABLE style="BORDER-COLLAPSE: collapse" 
            id=ctl00_RateArticle_VoteRBL class=radio border=0 cellSpacing=0 
            cellPadding=0>
              <TBODY>
              <TR>
                <TD><INPUT id=ctl00_RateArticle_VoteRBL_0 
                  onclick="ChkRtctl00_RateArticle(1, 18975);&#10;$('#ctl00_RateArticle_RCD').show();&#10;;" 
                  value=1 type=radio name=ctl00$RateArticle$VoteRBL></TD>
                <TD><INPUT id=ctl00_RateArticle_VoteRBL_1 
                  onclick="ChkRtctl00_RateArticle(2, 18975);&#10;$('#ctl00_RateArticle_RCD').show();&#10;;" 
                  value=2 type=radio name=ctl00$RateArticle$VoteRBL></TD>
                <TD><INPUT id=ctl00_RateArticle_VoteRBL_2 
                  onclick="ChkRtctl00_RateArticle(3, 18975);&#10;$('#ctl00_RateArticle_RCD').show();&#10;;" 
                  value=3 type=radio name=ctl00$RateArticle$VoteRBL></TD>
                <TD><INPUT id=ctl00_RateArticle_VoteRBL_3 
                  onclick="ChkRtctl00_RateArticle(4, 18975);&#10;$('#ctl00_RateArticle_RCD').show();&#10;;" 
                  value=4 type=radio name=ctl00$RateArticle$VoteRBL></TD>
                <TD><INPUT id=ctl00_RateArticle_VoteRBL_4 
                  onclick="ChkRtctl00_RateArticle(5, 18975);&#10;$('#ctl00_RateArticle_RCD').show();&#10;;" 
                  value=5 type=radio 
              name=ctl00$RateArticle$VoteRBL></TD></TR></TBODY></TABLE></TD>
          <TD id=ctl00_RateArticle_EndForm align=left><I>Excellent</I> </TD>
          <TD id=ctl00_RateArticle_VoteBtn><INPUT id=ctl00_RateArticle_SubmitRateBtn class=button onclick="return rateItem(18975,2,1,true,true,3);" value=Vote type=submit name=ctl00$RateArticle$SubmitRateBtn> 
          </TD></TR></TBODY></TABLE><SPAN id=ctl00_RateArticle_ErrorMessage 
      class=error></SPAN></TD></TR></TBODY></TABLE>
<DIV class=hover-container>
<DIV id=ctl00_RateArticle_RCD class="rating-comment align-left float-right">Add 
a reason or comment to your vote: <A id=clear-rate_ctl00_RateArticle_RCD 
title=close 
href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#">x</A><BR><TEXTAREA style="WIDTH: 98%" class=RateComment rows=5 cols=60></TEXTAREA> 
<SPAN id=ctl00_RateArticle_CommentReq class=subdue>Votes of 3 or less require a 
comment</SPAN> </DIV></DIV></DIV></DIV></DIV></FORM>
<DIV 
style="PADDING-BOTTOM: 0px; MARGIN: auto; PADDING-LEFT: 10px; WIDTH: 460px; PADDING-RIGHT: 10px; WHITE-SPACE: nowrap; HEIGHT: 60px; OVERFLOW: hidden; PADDING-TOP: 0px">
<DIV class=lqm_ad lqm_tags="VC6,Windows,Dev,Intermediate" lqm_country="CN" 
lqm_format="1" lqm_zone="77" lqm_publisher="495" lqm_channel="1" height="60px" 
width="468px"></DIV></DIV>
<H2>Comments and Discussions</H2><A id=_comments name=_comments></A>
<DIV id=_MessageBoard onclick="return SwitchMessage(event, null)">
<TABLE id=ForumTable class="box forum" cellSpacing=0 cellPadding=0>
  <TBODY>
  <TR>
    <TD>
      <TABLE border=0 cellSpacing=0 cellPadding=3 width="100%">
        <TBODY>
        <TR class=forum-header1>
          <TD style="WHITE-SPACE: nowrap"><IMG 
            style="BORDER-RIGHT-WIDTH: 0px; WIDTH: 16px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 16px; VERTICAL-ALIGN: middle; BORDER-LEFT-WIDTH: 0px" 
            alt=FAQ 
            src="Listing%20Used%20Files%20-%20CodeProject_files/info-16.gif">&nbsp;<A 
            href="http://www.codeproject.com/KB/FAQs/MessageBoardsFAQ.aspx"><B>FAQ</B></A>&nbsp;</TD>
          <TD style="TEXT-ALIGN: right; WHITE-SPACE: nowrap" colSpan=2>
            <FORM 
            style="PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: 0px; PADDING-TOP: 0px" 
            method=get action=/Search.aspx?fid=0><INPUT value=422864 type=hidden 
            name=fid><INPUT class=Frm_Input type=text name=qf>&nbsp;<INPUT class=button value=Search type=submit> 
          </FORM></TD></TR>
        <TR class=forum-header2>
          <TD style="WIDTH: 100%" colSpan=3>
            <DIV style="TEXT-ALIGN: right">
            <FORM 
            style="PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: 0px; PADDING-TOP: 0px" 
            method=get 
            action=/script/Forums/SetOptions.aspx?floc=%2fKB%2fshell%2fOpenedFileFinder.aspx&amp;fid=422864&amp;df=90&amp;mpp=25&amp;noise=3&amp;prof=False&amp;sort=Position&amp;view=Quick><INPUT 
            value=422864 type=hidden name=fid><INPUT 
            value=?floc=%2fKB%2fshell%2fOpenedFileFinder.aspx&amp;fid=422864&amp;df=90&amp;mpp=25&amp;noise=3&amp;prof=False&amp;sort=Position&amp;view=Quick 
            type=hidden name=currentQS><INPUT 
            value=/KB/shell/OpenedFileFinder.aspx type=hidden name=floc><INPUT 
            style="VERTICAL-ALIGN: middle" id=prof type=checkbox 
            name=prof><LABEL for=prof>Profile 
            popups</LABEL>&nbsp;&nbsp;&nbsp;&nbsp;Noise level<SELECT 
            class=Frm_DropDown size=1 name=noise> <OPTION value=1>Very 
              High</OPTION><OPTION value=2>High</OPTION><OPTION selected 
              value=3>Medium</OPTION><OPTION value=4>Low</OPTION><OPTION 
              value=5>Very Low</OPTION></SELECT>&nbsp;&nbsp;Layout<SELECT 
            class=Frm_DropDown size=1 name=view> <OPTION selected 
              value=Quick>Normal</OPTION><OPTION value=Topic>Expand Posts 
              only</OPTION><OPTION value=Expanded>Expand Posts &amp; 
              Replies</OPTION><OPTION value=Thread>Thread View</OPTION><OPTION 
              value=Normal>No Javascript</OPTION><OPTION value=Preview>No JS + 
              Preview</OPTION></SELECT>&nbsp;&nbsp;Per page<SELECT 
            class=Frm_DropDown size=1 name=mpp> <OPTION 
              value=10>10</OPTION><OPTION selected value=25>25</OPTION><OPTION 
              value=50>50</OPTION></SELECT>&nbsp;&nbsp;&nbsp;<INPUT class=button value=Update type=submit name=SetOpt> 
            </FORM></DIV></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD><A name=xx0xx></A>
      <TABLE border=0 cellSpacing=0 cellPadding=2 width="100%">
        <TBODY>
        <TR class=forum-navbar>
          <TD><IMG border=0 alt=new align=top 
            src="Listing%20Used%20Files%20-%20CodeProject_files/forum_newmsg.gif" 
            width=16 height=16><A class=toolbar 
            title="Create a new message thread" 
            href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;floc=/KB/shell/OpenedFileFinder.aspx" 
            name=Frm_HoverNL target=_top><B>New Message</B></A></TD>
          <TD>Msgs 1 to 25 of 137 (Total in Forum: 137) (<A 
            href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;noise=3&amp;prof=False&amp;sort=Position&amp;view=Quick">Refresh</A>)</TD>
          <TD style="TEXT-ALIGN: right; WHITE-SPACE: nowrap"><SPAN 
            class=subdue>First</SPAN> <SPAN class=subdue>Prev</SPAN><A 
            class=toolbar 
            href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;noise=3&amp;prof=False&amp;sort=Position&amp;view=Quick&amp;fr=26#xx0xx" 
            name=Frm_HoverNL>Next</A></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD>
      <TABLE class="fixed-layout blank-background" border=0 cellSpacing=0 
      cellPadding=0 width="100%">
        <TBODY>
        <TR>
          <TD><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=5></TD></TR>
        <TR id=F3934282_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx3934282xx></A><IMG 
                  alt=Question align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_question.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3934282/Problems-with-Windows2003-64bit.aspx" 
                  name=3934282 rel=nofollow parent="0">Problems with 
                  Windows2003, 64bit</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=6453472">abxd</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>16hrs 39mins 
        ago&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3934282_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Hello<BR>I have downloaded your demo 
                              application and tryed to find using it file 
                              test.docx opened by Word. On Windows XP 32bit it 
                              works fine and opened file is found, but on 
                              Windows2003 64bit it can't find the file. Seems 
                              that problems with 64-bit version are still there 
                              or demo application was not updated after 
                            fix.<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3934282&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3934282&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3934282">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3934282/Problems-with-Windows2003-64bit.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3934282&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3934282>
                              <SCRIPT type=text/javascript>
MsgVFrm(6453472,3934282,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3869322_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx3869322xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3869322/My-vote-of-5.aspx" 
                  name=3869322 rel=nofollow parent="0">My vote of 5</A> <A 
                  title="Click to pin message" onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=5338600">iye15</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>14:35 26 Apr '11 
          &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3869322_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>great article<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3869322&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3869322&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3869322">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3869322/My-vote-of-5.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3869322&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3869322>
                              <SCRIPT type=text/javascript>
MsgVFrm(5338600,3869322,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3867859_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx3867859xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3867859/Question-on-terminating-a-thread.aspx" 
                  name=3867859 rel=nofollow parent="0">Question on terminating a 
                  thread</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=5338600">iye15</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>15:59 25 Apr '11 
          &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3867859_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Hi,<BR>&nbsp;<BR>First of all, thank 
                              you for your post. This is a great article.<BR>I 
                              have also read many posts on resolving handle to 
                              get file path and yours is probably the best out 
                              of all the ones that I have seen in that it uses 
                              the same thread instead of creating the new one 
                              each time.<BR>&nbsp;<BR>However, I am just curious 
                              if it is fine to call CancelIo() with the handle 
                              when we get timed out. I also implemented 
                              something like yours and had an issue with hanging 
                              and in my application I used CancelIo() instead of 
                              TerminateThread() and that seems to work fine in 
                              that I did not have to terminate the thread and 
                              hence avoid any type of memory leak. If you can 
                              think of any potential issues with calling 
                              CancelIo(), please kindly let me know. Thanks a 
                              lot.<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3867859&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3867859&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3867859">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3867859/Question-on-terminating-a-thread.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3867859&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3867859>
                              <SCRIPT type=text/javascript>
MsgVFrm(5338600,3867859,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3868136_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=34><A name=xx3868136xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3868136/Re-Question-on-terminating-a-thread.aspx" 
                  name=3868136 rel=nofollow parent="3867859">Re: Question on 
                  terminating a thread</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                  title=associate border=0 alt=associate 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=1599046"><FONT 
                  color=#ff0000>N</FONT>aveen</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>1:48 26 Apr '11 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3868136_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 34px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=34 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Thanks <IMG alt="Smile | :)" 
                              align=top 
                              src="Listing%20Used%20Files%20-%20CodeProject_files/smiley_smile.gif"> 
                              <BR>&nbsp;<BR>
                              <BLOCKQUOTE class=FQ>
                                <DIV class=FQA>iye15 wrote:</DIV>However, I am 
                                just curious if it is fine to call CancelIo() 
                                with the handle when <BR>we get timed out. 
                              </BLOCKQUOTE><BR>&nbsp;<BR>You are 
                              right..CancelIo() seems to be a better alternative 
                              then TerminateThread solution. I never thought of 
                              this option <IMG alt="D'Oh! | :doh:" align=top 
                              src="Listing%20Used%20Files%20-%20CodeProject_files/smiley_doh.gif"> 
                              . I dont foresee any problems with the CancelIO, 
                              though I havent used it so far. If I happen to see 
                              any problem with it, I will definitly let you 
                              know.. Thanks for the tip.<BR>
                              <DIV class=signature>nave<BR>&nbsp;<BR><SMALL><A 
                              href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=1599046">[My 
                              Articles]</A> <A 
                              href="http://0memory.blogspot.com/">[My 
                              Blog]</A></SMALL></DIV><BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3868136&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3868136&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3867859">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3868136/Re-Question-on-terminating-a-thread.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3868136&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3868136>
                              <SCRIPT type=text/javascript>
MsgVFrm(1599046,3868136,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3714105_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx3714105xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3714105/Opening-processes.aspx" 
                  name=3714105 rel=nofollow parent="0">Opening processes</A> <A 
                  title="Click to pin message" onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=5713539">MasterOfChaos</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>15:43 29 Dec '10 
          &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3714105_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>A few years ago I wrote something 
                              similar in Delphi. The key to opening some 
                              processes was obtaining the SeDebugPrivilege.<BR><PRE>EnablePrivilege(<SPAN class=code-string>'</SPAN><SPAN class=code-string>SeDebugPrivilege'</SPAN>);</PRE><PRE>function EnablePrivilege(<SPAN class=code-keyword>const</SPAN> Priv:<SPAN class=code-SDKkeyword>String</SPAN>):boolean; 
var 
  rl: Cardinal; 
  hToken: Cardinal; 
  tkp: TOKEN_PRIVILEGES; 
  p:^token_privileges; 
begin 
  p:=nil; 
  result:=true; 
  <SPAN class=code-keyword>if</SPAN> Win32Platform <SPAN class=code-keyword>&lt;</SPAN>&gt; VER_PLATFORM_WIN32_NT then exit; 
  result:=false; 
  <SPAN class=code-keyword>if</SPAN> not OpenProcessToken(GetCurrentProcess, TOKEN_ADJUST_PRIVILEGES or TOKEN_QUERY, hToken) 
    then exit; 
  <SPAN class=code-keyword>if</SPAN> not LookupPrivilegeValue(nil, Pchar(Priv), tkp.Privileges[<SPAN class=code-digit>0</SPAN>].Luid) 
    then exit; 
  tkp.Privileges[<SPAN class=code-digit>0</SPAN>].Attributes := SE_PRIVILEGE_ENABLED; 
  tkp.PrivilegeCount := <SPAN class=code-digit>1</SPAN>; 
  AdjustTokenPrivileges(hToken, False, tkp, <SPAN class=code-digit>0</SPAN>, p^, rl); 
  <SPAN class=code-keyword>if</SPAN> GetLastError <SPAN class=code-keyword>&lt;</SPAN>&gt; ERROR_SUCCESS then exit; 
  result:=true; 
end;</PRE>&nbsp;<BR>http://nopaste.info/58d1aed48f.html<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3714105&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3714105&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3714105">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3714105/Opening-processes.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3714105&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3714105>
                              <SCRIPT type=text/javascript>
MsgVFrm(5713539,3714105,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3714272_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=34><A name=xx3714272xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3714272/Re-Opening-processes.aspx" 
                  name=3714272 rel=nofollow parent="3714105">Re: Opening 
                  processes</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                  title=associate border=0 alt=associate 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=1599046"><FONT 
                  color=#ff0000>N</FONT>aveen</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>0:06 30 Dec '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3714272_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 34px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=34 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Sorry i didnt get your point. 
                              Enabling debug privilage is alreadry there in my 
                              code!<BR>
                              <DIV class=signature>nave<BR>&nbsp;<BR><SMALL><A 
                              href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=1599046">[My 
                              Articles]</A> <A 
                              href="http://0memory.blogspot.com/">[My 
                              Blog]</A></SMALL></DIV><BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3714272&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3714272&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3714105">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3714272/Re-Opening-processes.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3714272&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3714272>
                              <SCRIPT type=text/javascript>
MsgVFrm(1599046,3714272,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3714024_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx3714024xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3714024/sample-for-use-in-Csharp.aspx" 
                  name=3714024 rel=nofollow parent="0">sample for use in C#</A> 
                  <A title="Click to pin message" onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=3595275">alhambra-eidos</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>14:04 29 Dec '10 
          &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3714024_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>it's great, thx.<BR>&nbsp;<BR>Can I 
                              use it in C# , easy way ?? any sample please 
                              ??<BR>&nbsp;<BR>I dont know C neither C++. I only 
                              want add Reference in Visual Studio 2008-2010 for 
                              C# project, and use it in my API.<BR>
                              <DIV class=signature>AE</DIV><BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3714024&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3714024&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3714024">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3714024/sample-for-use-in-Csharp.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3714024&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3714024>
                              <SCRIPT type=text/javascript>
MsgVFrm(3595275,3714024,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3714271_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=34><A name=xx3714271xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3714271/Re-sample-for-use-in-Csharp.aspx" 
                  name=3714271 rel=nofollow parent="3714024">Re: sample for use 
                  in C#</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                  title=associate border=0 alt=associate 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=1599046"><FONT 
                  color=#ff0000>N</FONT>aveen</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>0:05 30 Dec '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3714271_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 34px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=34 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>
                              <BLOCKQUOTE class=FQ>
                                <DIV class=FQA>alhambra-eidos wrote:</DIV>Can I 
                                use it in C# , easy way ?? any sample please 
                              ??</BLOCKQUOTE><BR>&nbsp;<BR>check the thread <A 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?msg=3633894#xx3633894xx">http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?msg=3633894#xx3633894xx</A>[<A 
                              title="New Window" 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?msg=3633894#xx3633894xx" 
                              target=_blank>^</A>]. I have wrote code to call 
                              this from vb.net. just change the syntax to that 
                              of C#.<BR>
                              <DIV class=signature>nave<BR>&nbsp;<BR><SMALL><A 
                              href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=1599046">[My 
                              Articles]</A> <A 
                              href="http://0memory.blogspot.com/">[My 
                              Blog]</A></SMALL></DIV><BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3714271&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3714271&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3714024">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3714271/Re-sample-for-use-in-Csharp.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3714271&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3714271>
                              <SCRIPT type=text/javascript>
MsgVFrm(1599046,3714271,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3665515_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx3665515xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3665515/My-vote-of-5.aspx" 
                  name=3665515 rel=nofollow parent="0">My vote of 5</A> <A 
                  title="Click to pin message" onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                  title=supporter border=0 alt=supporter 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/supporter_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=18885">yarp</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>2:53 14 Nov '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3665515_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Very useful to debug softwares. 
                              Thank you.<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3665515&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3665515">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3665515/My-vote-of-5.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3665515&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3665515>
                              <SCRIPT type=text/javascript>
MsgVFrm(18885,3665515,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3634389_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx3634389xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3634389/Open-directory.aspx" 
                  name=3634389 rel=nofollow parent="0">Open directory</A> <A 
                  title="Click to pin message" onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=3882269">ALBERT_TG77</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>14:15 15 Oct '10 
          &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3634389_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Hello,<BR>&nbsp;<BR>If I call the 
                              method in a directory where there is no file open 
                              i get 2 lines that tell me that something is 
                              open.<BR>If I open a file in the directory I get 3 
                              lines.<BR>&nbsp;<BR>I'd only want to know when a 
                              file is open not when de directory is 
                              open.<BR>&nbsp;<BR>It's possible?<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3634389&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3634389&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3634389">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3634389/Open-directory.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3634389&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3634389>
                              <SCRIPT type=text/javascript>
MsgVFrm(3882269,3634389,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3635607_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=34><A name=xx3635607xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3635607/Re-Open-directory.aspx" 
                  name=3635607 rel=nofollow parent="3634389">Re: Open 
                  directory</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                  title=associate border=0 alt=associate 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=1599046"><FONT 
                  color=#ff0000>N</FONT>aveen</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>1:25 18 Oct '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3635607_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 34px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=34 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>When you receive each file name in 
                              the callback, you can call the <A 
                              href="http://msdn.microsoft.com/en-us/library/bb773621(VS.85).aspx">PathIsDirectory</A>[<A 
                              title="New Window" 
                              href="http://msdn.microsoft.com/en-us/library/bb773621(VS.85).aspx" 
                              target=_blank>^</A>] function to find out whether 
                              it is a directory or file. If it is directory, 
                              simply ignore it..<BR>
                              <DIV class=signature>nave<BR>&nbsp;<BR><SMALL><A 
                              href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=1599046">[My 
                              Articles]</A> <A 
                              href="http://0memory.blogspot.com/">[My 
                              Blog]</A></SMALL></DIV><BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3635607&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3635607&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3634389">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3635607/Re-Open-directory.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3635607&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3635607>
                              <SCRIPT type=text/javascript>
MsgVFrm(1599046,3635607,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3629857_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx3629857xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3629857/Use-the-dll-in-a-visual-studio-project.aspx" 
                  name=3629857 rel=nofollow parent="0">Use the dll in a visual 
                  studio project</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=3882269">ALBERT_TG77</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>5:58 13 Oct '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3629857_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Hello,<BR>&nbsp;<BR>I'd like to use 
                              the dll in a visual studio project in order to 
                              find if a specific file is open.<BR>&nbsp;<BR>How 
                              do i have to tho 
                          this?<BR>&nbsp;<BR>Thanks.<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3629857&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3629857&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3629857">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3629857/Use-the-dll-in-a-visual-studio-project.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3629857&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3629857>
                              <SCRIPT type=text/javascript>
MsgVFrm(3882269,3629857,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3629922_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=34><A name=xx3629922xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3629922/Re-Use-the-dll-in-a-visual-studio-project.aspx" 
                  name=3629922 rel=nofollow parent="3629857">Re: Use the dll in 
                  a visual studio project</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                  title=associate border=0 alt=associate 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=1599046"><FONT 
                  color=#ff0000>N</FONT>aveen</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>6:27 13 Oct '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3629922_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 34px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=34 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Check the section "How Third Party 
                              Applications Can Make Use of This Application"<BR>
                              <DIV class=signature>nave<BR>&nbsp;<BR><SMALL><A 
                              href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=1599046">[My 
                              Articles]</A> <A 
                              href="http://0memory.blogspot.com/">[My 
                              Blog]</A></SMALL></DIV><BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3629922&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3629922&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3629857">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3629922/Re-Use-the-dll-in-a-visual-studio-project.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3629922&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3629922>
                              <SCRIPT type=text/javascript>
MsgVFrm(1599046,3629922,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3629935_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=52><A name=xx3629935xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3629935/Re-Use-the-dll-in-a-visual-studio-project.aspx" 
                  name=3629935 rel=nofollow parent="3629922">Re: Use the dll in 
                  a visual studio project</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=3882269">ALBERT_TG77</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>6:33 13 Oct '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3629935_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 52px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=52 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>I've done this.<BR>&nbsp;<BR>But the 
                              problem if that I don't know to put a reference to 
                              the library in a Visual Studio project.<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3629935&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3629935&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3629857">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3629935/Re-Use-the-dll-in-a-visual-studio-project.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3629935&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3629935>
                              <SCRIPT type=text/javascript>
MsgVFrm(3882269,3629935,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3629945_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=70><A name=xx3629945xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3629945/Re-Use-the-dll-in-a-visual-studio-project.aspx" 
                  name=3629945 rel=nofollow parent="3629935">Re: Use the dll in 
                  a visual studio project</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                  title=associate border=0 alt=associate 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=1599046"><FONT 
                  color=#ff0000>N</FONT>aveen</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>6:38 13 Oct '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3629945_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 70px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=70 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>What kind of project is yours? I 
                              mean its a vc++ or C#.net or vb.net project?<BR>
                              <DIV class=signature>nave<BR>&nbsp;<BR><SMALL><A 
                              href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=1599046">[My 
                              Articles]</A> <A 
                              href="http://0memory.blogspot.com/">[My 
                              Blog]</A></SMALL></DIV><BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3629945&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3629945&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3629857">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3629945/Re-Use-the-dll-in-a-visual-studio-project.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3629945&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3629945>
                              <SCRIPT type=text/javascript>
MsgVFrm(1599046,3629945,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3630088_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=88><A name=xx3630088xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3630088/Re-Use-the-dll-in-a-visual-studio-project.aspx" 
                  name=3630088 rel=nofollow parent="3629945">Re: Use the dll in 
                  a visual studio project</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=3882269">ALBERT_TG77</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>7:38 13 Oct '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3630088_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 88px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=88 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>It's an VB.net 
                              project.<BR>&nbsp;<BR>Thanks<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3630088&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3630088&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3629857">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3630088/Re-Use-the-dll-in-a-visual-studio-project.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3630088&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3630088>
                              <SCRIPT type=text/javascript>
MsgVFrm(3882269,3630088,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3630158_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=106><A name=xx3630158xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3630158/Re-Use-the-dll-in-a-visual-studio-project.aspx" 
                  name=3630158 rel=nofollow parent="3630088">Re: Use the dll in 
                  a visual studio project</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                  title=associate border=0 alt=associate 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=1599046"><FONT 
                  color=#ff0000>N</FONT>aveen</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>8:02 13 Oct '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3630158_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 106px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=106 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>In that case you can call the 
                              functions in the "OpenFileFinder.dll" using 
                              pinvoke. If you are not aware of the pinvoke 
                              method, refer to the article <A 
                              href="http://www.codeguru.com/csharp/.net/net_general/article.php/c4595">Platform 
                              Invoke</A>[<A title="New Window" 
                              href="http://www.codeguru.com/csharp/.net/net_general/article.php/c4595" 
                              target=_blank>^</A>]<BR>
                              <DIV class=signature>nave<BR>&nbsp;<BR><SMALL><A 
                              href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=1599046">[My 
                              Articles]</A> <A 
                              href="http://0memory.blogspot.com/">[My 
                              Blog]</A></SMALL></DIV><BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3630158&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3630158&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3629857">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3630158/Re-Use-the-dll-in-a-visual-studio-project.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3630158&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3630158>
                              <SCRIPT type=text/javascript>
MsgVFrm(1599046,3630158,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3630944_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=116><A name=xx3630944xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3630944/Re-Use-the-dll-in-a-visual-studio-project.aspx" 
                  name=3630944 rel=nofollow parent="3630158">Re: Use the dll in 
                  a visual studio project</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=3882269">ALBERT_TG77</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>16:41 13 Oct '10 
          &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3630944_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 116px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=116 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>i can't manage to do 
                              this.<BR>&nbsp;<BR>Can you tell me how 
                          to?<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3630944&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3630944&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3629857">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3630944/Re-Use-the-dll-in-a-visual-studio-project.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3630944&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3630944>
                              <SCRIPT type=text/javascript>
MsgVFrm(3882269,3630944,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3631245_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=126><A name=xx3631245xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3631245/Re-Use-the-dll-in-a-visual-studio-project.aspx" 
                  name=3631245 rel=nofollow parent="3630944">Re: Use the dll in 
                  a visual studio project</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                  title=associate border=0 alt=associate 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=1599046"><FONT 
                  color=#ff0000>N</FONT>aveen</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>2:28 14 Oct '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3631245_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 126px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=126 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>like this<BR>&nbsp;<BR><PRE>Imports System.Runtime.InteropServices
Public Class Form1
    <SPAN class=code-keyword>&lt;</SPAN>DllImport(<SPAN class=code-string>"</SPAN><SPAN class=code-string>OpenFileFinder"</SPAN>, CallingConvention:=CallingConvention.Cdecl, CharSet:=CharSet.Unicode)<SPAN class=code-keyword>&gt;</SPAN>
    Shared Sub ShowOpenedFiles(ByVal path As <SPAN class=code-SDKkeyword>String</SPAN>)
    End Sub
&nbsp;
    Private Sub Form1_Load(ByVal sender As System.<SPAN class=code-SDKkeyword>Object</SPAN>, ByVal e As System.EventArgs) Handles MyBase.Load
        ShowOpenedFiles(<SPAN class=code-string>"</SPAN><SPAN class=code-string>c:\")
    End Sub
End Class</SPAN></PRE>
                              <DIV class=signature>nave<BR>&nbsp;<BR><SMALL><A 
                              href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=1599046">[My 
                              Articles]</A> <A 
                              href="http://0memory.blogspot.com/">[My 
                              Blog]</A></SMALL></DIV><BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3631245&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3631245&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3629857">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3631245/Re-Use-the-dll-in-a-visual-studio-project.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3631245&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3631245>
                              <SCRIPT type=text/javascript>
MsgVFrm(1599046,3631245,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3631341_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=136><A name=xx3631341xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3631341/Re-Use-the-dll-in-a-visual-studio-project.aspx" 
                  name=3631341 rel=nofollow parent="3631245">Re: Use the dll in 
                  a visual studio project</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=3882269">ALBERT_TG77</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>3:52 14 Oct '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3631341_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 136px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=136 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Great!!<BR>&nbsp;<BR>but i need the 
                              function GetOpenedFiles and i don't know wich type 
                              of parametres are needed.<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3631341&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3631341&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3629857">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3631341/Re-Use-the-dll-in-a-visual-studio-project.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3631341&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3631341>
                              <SCRIPT type=text/javascript>
MsgVFrm(3882269,3631341,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3632228_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=136><A name=xx3632228xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3632228/Re-Use-the-dll-in-a-visual-studio-project.aspx" 
                  name=3632228 rel=nofollow parent="3631245">Re: Use the dll in 
                  a visual studio project</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=3882269">ALBERT_TG77</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>11:47 14 Oct '10 
          &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3632228_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 136px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=136 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Hello<BR>&nbsp;<BR>I'm triying the 
                              same with GetOpenedFiles method but I'm not able 
                              to do this.<BR>Can you 
                              help?<BR>&nbsp;<BR>Thanks<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3632228&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3632228&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3629857">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3632228/Re-Use-the-dll-in-a-visual-studio-project.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3632228&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3632228>
                              <SCRIPT type=text/javascript>
MsgVFrm(3882269,3632228,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3633894_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=146><A name=xx3633894xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3633894/Re-Use-the-dll-in-a-visual-studio-project.aspx" 
                  name=3633894 rel=nofollow parent="3632228">Re: Use the dll in 
                  a visual studio project</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                  title=associate border=0 alt=associate 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=1599046"><FONT 
                  color=#ff0000>N</FONT>aveen</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>9:43 15 Oct '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3633894_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 146px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=146 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2><PRE><SPAN class=code-keyword>Imports</SPAN> System.Runtime.InteropServices
<SPAN class=code-keyword>Public</SPAN> <SPAN class=code-keyword>Class</SPAN> Form1
    <SPAN class=code-keyword>Public</SPAN> <SPAN class=code-keyword>Delegate</SPAN> <SPAN class=code-keyword>Sub</SPAN> CallBackFuncDef(<SPAN class=code-keyword>ByVal</SPAN> fileinfo <SPAN class=code-keyword>As</SPAN> OF_INFO_t, <SPAN class=code-keyword>ByVal</SPAN> context <SPAN class=code-keyword>As</SPAN> <SPAN class=code-SDKkeyword>IntPtr</SPAN>)
    &lt;StructLayout(LayoutKind.Sequential, CharSet:=CharSet.Unicode)&gt;
    <SPAN class=code-keyword>Structure</SPAN> OF_INFO_t
        <SPAN class=code-keyword>Dim</SPAN> processid <SPAN class=code-keyword>As</SPAN> <SPAN class=code-keyword>Integer</SPAN>
        <SPAN class=code-keyword>Dim</SPAN> filename <SPAN class=code-keyword>As</SPAN> <SPAN class=code-keyword>String</SPAN>
        <SPAN class=code-keyword>Dim</SPAN> handlevalue <SPAN class=code-keyword>As</SPAN> <SPAN class=code-SDKkeyword>IntPtr</SPAN>
    <SPAN class=code-keyword>End</SPAN> <SPAN class=code-keyword>Structure</SPAN>
&nbsp;
    &lt;DllImport(<SPAN class=code-string>"</SPAN><SPAN class=code-string>OpenFileFinder"</SPAN>, CallingConvention:=CallingConvention.Cdecl, CharSet:=CharSet.Unicode)&gt;
    <SPAN class=code-keyword>Shared</SPAN> <SPAN class=code-keyword>Sub</SPAN> GetOpenedFiles(<SPAN class=code-keyword>ByVal</SPAN> path <SPAN class=code-keyword>As</SPAN> <SPAN class=code-keyword>String</SPAN>, <SPAN class=code-keyword>ByVal</SPAN> Filter <SPAN class=code-keyword>As</SPAN> <SPAN class=code-keyword>Integer</SPAN>, <SPAN class=code-keyword>ByVal</SPAN> CallBackProc <SPAN class=code-keyword>As</SPAN> CallBackFuncDef, <SPAN class=code-keyword>ByVal</SPAN> pUserContext <SPAN class=code-keyword>As</SPAN> <SPAN class=code-SDKkeyword>IntPtr</SPAN>)
    <SPAN class=code-keyword>End</SPAN> <SPAN class=code-keyword>Sub</SPAN>
&nbsp;
    <SPAN class=code-keyword>Private</SPAN> <SPAN class=code-keyword>Sub</SPAN> Form1_Load(<SPAN class=code-keyword>ByVal</SPAN> sender <SPAN class=code-keyword>As</SPAN> System.<SPAN class=code-keyword>Object</SPAN>, <SPAN class=code-keyword>ByVal</SPAN> e <SPAN class=code-keyword>As</SPAN> System.EventArgs) <SPAN class=code-keyword>Handles</SPAN> <SPAN class=code-keyword>MyBase</SPAN>.Load
        GetOpenedFiles(<SPAN class=code-string>"</SPAN><SPAN class=code-string>c:\"</SPAN>, <SPAN class=code-digit>3</SPAN>, <SPAN class=code-keyword>AddressOf</SPAN> MyCallBack, <SPAN class=code-digit>0</SPAN>)
    <SPAN class=code-keyword>End</SPAN> <SPAN class=code-keyword>Sub</SPAN>
&nbsp;
    <SPAN class=code-keyword>Private</SPAN> <SPAN class=code-keyword>Sub</SPAN> MyCallBack(<SPAN class=code-keyword>ByVal</SPAN> fileinfo <SPAN class=code-keyword>As</SPAN> OF_INFO_t, <SPAN class=code-keyword>ByVal</SPAN> context <SPAN class=code-keyword>As</SPAN> <SPAN class=code-SDKkeyword>IntPtr</SPAN>)
        MsgBox(fileinfo.filename)
    <SPAN class=code-keyword>End</SPAN> <SPAN class=code-keyword>Sub</SPAN>
&nbsp;
<SPAN class=code-keyword>End</SPAN> <SPAN class=code-keyword>Class</SPAN></PRE>
                              <DIV class=signature>nave<BR>&nbsp;<BR><SMALL><A 
                              href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=1599046">[My 
                              Articles]</A> <A 
                              href="http://0memory.blogspot.com/">[My 
                              Blog]</A></SMALL></DIV><BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3633894&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3633894&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3629857">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3633894/Re-Use-the-dll-in-a-visual-studio-project.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3633894&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3633894>
                              <SCRIPT type=text/javascript>
MsgVFrm(1599046,3633894,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3634386_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=156><A name=xx3634386xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3634386/Re-Use-the-dll-in-a-visual-studio-project.aspx" 
                  name=3634386 rel=nofollow parent="3633894">Re: Use the dll in 
                  a visual studio project</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=3882269">ALBERT_TG77</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>14:12 15 Oct '10 
          &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3634386_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 156px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=156 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Thanks it's great!!!<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3634386&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3634386&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3629857">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3634386/Re-Use-the-dll-in-a-visual-studio-project.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3634386&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3634386>
                              <SCRIPT type=text/javascript>
MsgVFrm(3882269,3634386,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3714372_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=156><A name=xx3714372xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3714372/Re-Use-the-dll-in-a-visual-studio-project.aspx" 
                  name=3714372 rel=nofollow parent="3633894">Re: Use the dll in 
                  a visual studio project</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=3595275">alhambra-eidos</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>2:42 30 Dec '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3714372_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 156px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=156 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>I need register OpenFileFinder.dll 
                              using regsvr32 ?? or only copy in 
                              c:\windows\system32 ??<BR>&nbsp;<BR>I need do 
                              something like Unlocker tools, get the files 
                              opened and in use for another process. When I try 
                              delete any files using C# (my applications and wcf 
                              service), sometimes get the error that the file is 
                              in use by another process.<BR>&nbsp;<BR>thx<BR>
                              <DIV class=signature>AE</DIV><BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3714372&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3714372&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3629857">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3714372/Re-Use-the-dll-in-a-visual-studio-project.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3714372&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3714372>
                              <SCRIPT type=text/javascript>
MsgVFrm(3595275,3714372,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=1></TD></TR>
        <TR id=F3714606_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=161><A name=xx3714606xx></A><IMG 
                  alt=General align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A 
                  class=message-link 
                  href="http://www.codeproject.com/Messages/3714606/Re-Use-the-dll-in-a-visual-studio-project.aspx" 
                  name=3714606 rel=nofollow parent="3714372">Re: Use the dll in 
                  a visual studio project</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                  title=associate border=0 alt=associate 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=1599046"><FONT 
                  color=#ff0000>N</FONT>aveen</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>7:23 30 Dec '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR>
        <TR style="DISPLAY: none" id=F3714606_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 161px" class=Frm_MsgIndent><IMG alt="" 
                  src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
                  width=161 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>if you are using it from your 
                              application only, then no need to register. just 
                              put in the folder where your application's exe 
                              is<BR>&nbsp;<BR>Registering the dll is to get the 
                              context menu option in explorer.<BR>
                              <DIV class=signature>nave<BR>&nbsp;<BR><SMALL><A 
                              href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=1599046">[My 
                              Articles]</A> <A 
                              href="http://0memory.blogspot.com/">[My 
                              Blog]</A></SMALL></DIV><BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar title=Reply 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3714606&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=r">Reply</A>·<A 
                              class=toolbar title=Email 
                              href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=422864&amp;select=3714606&amp;floc=/KB/shell/OpenedFileFinder.aspx&amp;action=e">Email</A>·<A 
                              class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3629857">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3714606/Re-Use-the-dll-in-a-visual-studio-project.aspx">Permalink</A>·<A 
                              class=toolbar title="Bookmark this post" 
                              href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3714606&amp;obtid=3&amp;action=AddBookmark&amp;bio=false">Bookmark</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3714606>
                              <SCRIPT type=text/javascript>
MsgVFrm(1599046,3714606,false,"","","");
</SCRIPT>
                              </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD><IMG border=0 alt="" 
            src="Listing%20Used%20Files%20-%20CodeProject_files/t(1).gif" 
            width=1 height=5></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD>
      <TABLE cellSpacing=0 cellPadding=2 width="100%">
        <TBODY>
        <TR class=forum-footer>
          <TD>Last Visit: 1:45 23 Jun '11 &nbsp; &nbsp; Last Update: 1:52 23 
            Jun '11 </TD>
          <TD style="TEXT-ALIGN: right; WHITE-SPACE: nowrap"><INPUT id=_mbnUrl 
            value=/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;noise=3&amp;prof=False&amp;sort=Position&amp;view=Quick&amp;fr=26 
            type=hidden><B>1</B><A class=toolbar 
            href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;noise=3&amp;prof=False&amp;sort=Position&amp;view=Quick&amp;fr=26#xx0xx" 
            name=Frm_HoverNL>2</A><A class=toolbar 
            href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;noise=3&amp;prof=False&amp;sort=Position&amp;view=Quick&amp;fr=51#xx0xx" 
            name=Frm_HoverNL>3</A><A class=toolbar 
            href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;noise=3&amp;prof=False&amp;sort=Position&amp;view=Quick&amp;fr=76#xx0xx" 
            name=Frm_HoverNL>4</A><A class=toolbar 
            href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;noise=3&amp;prof=False&amp;sort=Position&amp;view=Quick&amp;fr=101#xx0xx" 
            name=Frm_HoverNL>5</A><A class=toolbar 
            href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;noise=3&amp;prof=False&amp;sort=Position&amp;view=Quick&amp;fr=126#xx0xx" 
            name=Frm_HoverNL>6</A> <A class=toolbar 
            href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?fid=422864&amp;df=90&amp;mpp=25&amp;noise=3&amp;prof=False&amp;sort=Position&amp;view=Quick&amp;fr=26#xx0xx" 
            name=Frm_HoverNL>Next 
»</A></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
<P class=small-text><IMG alt=General align=top 
src="Listing%20Used%20Files%20-%20CodeProject_files/msg_general.gif" width=16 
height=16> General &nbsp;&nbsp; <IMG alt=News align=top 
src="Listing%20Used%20Files%20-%20CodeProject_files/msg_news.gif" width=16 
height=16> News &nbsp;&nbsp; <IMG alt=Suggestion align=top 
src="Listing%20Used%20Files%20-%20CodeProject_files/msg_idea.gif" width=16 
height=16> Suggestion &nbsp;&nbsp; <IMG alt=Question align=top 
src="Listing%20Used%20Files%20-%20CodeProject_files/msg_question.gif" width=16 
height=16> Question &nbsp;&nbsp; <IMG alt=Bug align=top 
src="Listing%20Used%20Files%20-%20CodeProject_files/msg_bug.gif" width=16 
height=16> Bug &nbsp;&nbsp; <IMG alt=Answer align=top 
src="Listing%20Used%20Files%20-%20CodeProject_files/msg_answer.gif" width=16 
height=16> Answer &nbsp;&nbsp; <IMG alt=Joke align=top 
src="Listing%20Used%20Files%20-%20CodeProject_files/msg_joke.gif" width=16 
height=16> Joke &nbsp;&nbsp; <IMG alt=Rant align=top 
src="Listing%20Used%20Files%20-%20CodeProject_files/msg_rant.gif" width=16 
height=16> Rant &nbsp;&nbsp; <IMG alt=Admin align=top 
src="Listing%20Used%20Files%20-%20CodeProject_files/msg_admin.gif" width=16 
height=16> Admin &nbsp;&nbsp; </P>
<P class=small-text>Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to 
switch threads, Ctrl+PgUp/PgDown to switch pages.</P>
<DIV style="HEIGHT: 2px" class=theme1-background></DIV>
<DIV class="extended tiny-text">
<DIV class=row>
<DIV class=float-left><A id=ctl00_PermaLink 
href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx">Permalink</A> | 
<A id=ctl00_AdvertiseLink 
href="http://www.codeproject.com/info/MediaKit.aspx">Advertise </A>| <A 
id=ctl00_PrivacyLink 
href="http://www.codeproject.com/info/privacy.aspx">Privacy</A> | <A 
id=ctl00_Mobile 
href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?display=Mobile">Mobile</A> 
<BR>| Web21 | 2.3.110622.2 </DIV>
<DIV class="float-right align-right">Article Copyright 2007 by <FONT 
color=#ff0000>N</FONT>aveen<BR>Everything else Copyright © <A 
href="mailto:webmaster@codeproject.com">CodeProject</A>, 1999-2011<BR><A 
id=ctl00_TermsOfUseLink 
href="http://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</A> </DIV>
<DIV class=page-width>Layout: <A id=ctl00_PageWidth_FixedT 
title="Fixed width layout" 
href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?PageFlow=FixedWidth">fixed</A> 
| <A id=ctl00_PageWidth_FluidT title="Fluid layout" 
href="http://www.codeproject.com/KB/shell/OpenedFileFinder.aspx?PageFlow=Fluid">fluid</A> 
</DIV></DIV></DIV><BR clear=all></DIV>
<DIV id=ctl00_ContentSide class=text-sidebar>
<DIV class="lqm_ad container-adwords" lqm_format="30" lqm_zone="77" 
lqm_publisher="495" lqm_channel="1"></DIV>
<SCRIPT type=text/javascript>document.write(unescape('%0d%0a%3cdiv class%3d%22announce%22%3e%0d%0a%0d%0a%3cdiv class%3d%22announce-content%22%3e%09%0d%0a%0d%0a%0d%0a%3cdiv class%3d%22container-adwords%22%3e%0d%0a%09%3ca id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl00_Link%22 href%3d%22%2fscript%2fCatalog%2fRedir.aspx%3fctid%3d3348%26amp%3bcttype%3d2%22 target%3d%22_blank%22%3e%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl00_Title%22 class%3d%22title%22%3eResco MobileApp Studio%3c%2fspan%3e%3cbr %2f%3e%0d%0a%09%09%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl00_Teaser%22 title%3d%22Advanced mobile developer platform.%22 class%3d%22desc%22%3eAdvanced mobile developer platform.%3c%2fspan%3e%3cbr %2f%3e%0d%0a%09%09%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl00_Url%22 class%3d%22link%22%3ewww.resco.net%3c%2fspan%3e%3c%2fa%3e%0d%0a%3c%2fdiv%3e%0d%0a%0d%0a%3cdiv class%3d%22container-adwords%22%3e%0d%0a%09%3ca id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl01_Link%22 href%3d%22%2fscript%2fCatalog%2fRedir.aspx%3fctid%3d2680%26amp%3bcttype%3d2%22 target%3d%22_blank%22%3e%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl01_Title%22 class%3d%22title%22%3eActiveReports for Silverlight%2c Windows Forms%2c ASP.NET%3c%2fspan%3e%3cbr %2f%3e%0d%0a%09%09%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl01_Teaser%22 title%3d%22ActiveReports by GrapeCity is an award-winning reporting tool for Silverlight%2c Windows Forms and ASP.NET with unmatched customization%2c fast performance and super high quality%2c all battle tested by tens of thousands of developers.%22 class%3d%22desc%22%3eActiveReports by GrapeCity is an award-winning...%3c%2fspan%3e%3cbr %2f%3e%0d%0a%09%09%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl01_Url%22 class%3d%22link%22%3ewww.gcpowertools.com%3c%2fspan%3e%3c%2fa%3e%0d%0a%3c%2fdiv%3e%0d%0a%0d%0a%3cdiv class%3d%22container-adwords%22%3e%0d%0a%09%3ca id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl02_Link%22 href%3d%22%2fscript%2fCatalog%2fRedir.aspx%3fctid%3d2968%26amp%3bcttype%3d2%22 target%3d%22_blank%22%3e%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl02_Title%22 class%3d%22title%22%3eSpread for Windows Forms%3c%2fspan%3e%3cbr %2f%3e%0d%0a%09%09%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl02_Teaser%22 title%3d%22New! Spread for Windows Forms 5 by GrapeCity is a full-featured Microsoft Excel compatible spreadsheet component with hundreds of chart styles%2c supports importing and exporting of native Excel files and unlimited customization options.%22 class%3d%22desc%22%3eNew! Spread for Windows Forms 5 by GrapeCity...%3c%2fspan%3e%3cbr %2f%3e%0d%0a%09%09%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl02_Url%22 class%3d%22link%22%3ewww.gcpowertools.com%3c%2fspan%3e%3c%2fa%3e%0d%0a%3c%2fdiv%3e%0d%0a%0d%0a%0d%0a%3c%2fdiv%3e%0d%0a%3c%2fdiv%3e%0d%0a%0d%0a%0d%0a'));</SCRIPT>

<DIV class=announce>
<DIV class=announce-header>See Also...</DIV>
<DIV class=announce-content>
<DIV class=container-related-item><A 
id=ctl00_RelatedArticles_RelatedItemRptr_ctl00_TitleLink class=title 
href="http://www.codeproject.com/KB/shell/shellextguide1.aspx">The Complete 
Idiot's Guide to Writing Shell Extensions - Part I</A><BR><SPAN 
id=ctl00_RelatedArticles_RelatedItemRptr_ctl00_Teaser class=desc>A step-by-step 
tutorial on writing shell...</SPAN><BR></DIV>
<DIV class=container-related-item><A 
id=ctl00_RelatedArticles_RelatedItemRptr_ctl01_TitleLink class=title 
href="http://www.codeproject.com/KB/files/handles.aspx">A Handy Guide To 
Handling Handles</A><BR><SPAN 
id=ctl00_RelatedArticles_RelatedItemRptr_ctl01_Teaser class=desc>The secrets of 
File Handles and their...</SPAN><BR></DIV>
<DIV class=container-related-item><A 
id=ctl00_RelatedArticles_RelatedItemRptr_ctl02_TitleLink class=title 
href="http://www.codeproject.com/KB/threads/winspy.aspx">Three Ways to Inject 
Your Code into Another Process</A><BR><SPAN 
id=ctl00_RelatedArticles_RelatedItemRptr_ctl02_Teaser class=desc>How to inject 
code into another processes...</SPAN><BR></DIV>
<DIV class=container-related-item><A 
id=ctl00_RelatedArticles_RelatedItemRptr_ctl03_TitleLink class=title 
href="http://www.codeproject.com/KB/shell/CShortcut.aspx">CShortcut (Shell links 
to special folders)</A><BR><SPAN 
id=ctl00_RelatedArticles_RelatedItemRptr_ctl03_Teaser class=desc>This class 
enables you to build shortcuts to...</SPAN><BR></DIV>
<DIV class=container-related-item><A 
id=ctl00_RelatedArticles_RelatedItemRptr_ctl04_TitleLink class=title 
href="http://www.codeproject.com/KB/IP/OpenFiles.aspx">An app to see who has 
files open on a network server</A><BR><SPAN 
id=ctl00_RelatedArticles_RelatedItemRptr_ctl04_Teaser class=desc>An app to see 
who has files open on a network...</SPAN><BR></DIV></DIV></DIV>
<DIV class=announce>
<DIV class=announce-header>The Daily Insider</DIV>
<DIV class=announce-content>
<DIV><A id=ctl00_News_News_ctl01_Link 
href="http://citizen428.net/archives/434">30 free programming 
books</A></DIV>Daily News: <A id=ctl00_News_News_ctl02_Subscribe 
href="http://www.codeproject.com/Feature/Insider/">Signup now</A>. </DIV></DIV>
<DIV style="MARGIN: auto; WIDTH: 150px">
<DIV class=lqm_ad lqm_tags="VC6,Windows,Dev,Intermediate" lqm_country="CN" 
lqm_format="21" lqm_zone="77" lqm_publisher="495" lqm_channel="1" height="80px" 
width="150px"></DIV></DIV>
<DIV style="MARGIN: 10px auto auto; WIDTH: 160px">
<DIV class=lqm_ad lqm_tags="VC6,Windows,Dev,Intermediate" lqm_country="CN" 
lqm_format="18" lqm_zone="77" lqm_publisher="495" lqm_channel="1" height="600px" 
width="160px"></DIV></DIV></DIV></DIV></DIV></DIV></DIV>
<DIV style="DISPLAY: none" id=lqm_AdTable></DIV>
<SCRIPT language=Javascript type=text/javascript 
src="Listing%20Used%20Files%20-%20CodeProject_files/jquery-1.4.2.min.js"></SCRIPT>

<SCRIPT type=text/javascript>//<![CDATA[
if (typeof jQuery == 'undefined') {
    document.write(unescape("%3Cscript src='/script/JS/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
}//]]></SCRIPT>

<SCRIPT language=Javascript type=text/javascript 
src="Listing%20Used%20Files%20-%20CodeProject_files/article.min.js"></SCRIPT>

<SCRIPT language=Javascript type=text/javascript 
src="Listing%20Used%20Files%20-%20CodeProject_files/m2.min.js"></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
var socialLinks = new social();
socialLinks.PlaceholderId="ATD";socialLinks.ObjectId=18975;
socialLinks.ObjectTypeId=2;
socialLinks.addtoMethod=1;
socialLinks.Horizontal=false;
socialLinks.Showname=true;
socialLinks.setupLinks("socialLinks", escape(document.location.href),escape(document.title), 100, 0, "small-text Bold", "AddTo");
socialLinks.setupMenu();
if($.LqmAds)$.LqmAds();
var oSrchFlt = false, oSrchBox=false,srchBoxFoc=false;
$(document).ready(function() {
 InitWatermark('sb_tb', 'Search');
 var sbar = $('#sb_tb'); 
 var sfilter = $('#SearchFilter');
 if (sbar && sfilter) {
  sfilter.removeClass('popup'); sfilter.hide();
  sbar.blur(function() { if (!oSrchFlt)sfilter.hide();srchBoxFoc=false; });
  sbar.focus(function() { oSrchFlt=false;srchBoxFoc=true;sfilter.show(); });
  sbar.mouseleave(function() { oSrchBox=false; });
  sbar.mouseover(function() { oSrchBox=true; });
  sfilter.mouseleave(function() { oSrchFlt=false; if (!srchBoxFoc&&!oSrchBox)sfilter.hide();});
  sfilter.mouseover(function() { oSrchFlt=true; });
 }
});
$(document).ready(function() { anchorAnimate(); });
$("#ctl00_RateArticle_RateItemWrapper").removeClass("container-rating");$('#clear-rate_ctl00_RateArticle_RCD').click(function () { $('#ctl00_RateArticle_RCD').hide(); return false;});
function ChkRtctl00_RateArticle(val, objId) {if (val<=3||true) {
$('div[name=RateItem_' + objId + '] .rating-comment').css("display","");}
else $('div[name=RateItem_' + objId + '] .rating-comment').css("display","none");}


//]]>
</SCRIPT>

<SCRIPT type=text/javascript>
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-1735123-1']);
	_gaq.push(['_trackPageview']);
	_gaq.push(['_setDomainName', 'www.codeproject.com']);
	_gaq.push(['_setSessionTimeout', '1200']); 

	(function () {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})(); 
</SCRIPT>
</BODY></HTML>
