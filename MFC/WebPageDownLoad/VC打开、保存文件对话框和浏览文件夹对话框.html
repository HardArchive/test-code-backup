<html><head><title>VC打开、保存文件对话框和浏览文件夹对话框_谢灬向_百度空间</title><meta http-equiv=content-type content="text/html; charset=GBK"><link rel=alternate type="application/rss+xml" title="订阅该空间的博客文章" href="http://hi.baidu.com/x3030/rss"><style type="text/css">.error{color:#F00;font-size:12px}.shareUser,.shareLastEditor{line-height:20px;color:#666;text-align:left}.shareLastEditor{margin:5px 0 8px}</style><script>
	    var g_pageTimerStart=new Date().getTime();
	</script><script src="http://hi.bdimg.com/static/cblog/js/other/global.js?v=a55deae0.js"></script><script src="http://hi.bdimg.com/static/cblog/js/other/libs.js?v=48b209f9.js"></script><script src="http://img.baidu.com/js/tangram-1.3.9.js?v=1343198164.js"></script><script>
var Session = {
    isLogin: !true,
    isHost: 0,
    loginStatus : 0,
    userName: "x3030",   
    userPortrait:'449b7833303330ab18',
    spaceURL: "\/x3030",
    spBasicURL:"http:\/\/hi.baidu.com\/x3030",
    spBasicURLEnc:"http%3A%2F%2Fhi.baidu.com%2Fx3030",
    visitorName:    "",
    visitorPortrait:'00000000',
    isActive: '0',   /*{cmt 访问者是否激活空间}*/
    visitorURL: "\/",        // 
    pageURL: "http://hi.baidu.com\/x3030\/blog\/item\/b119f61ae15ab415c83d6d49.html",    
    refer: "",
    spToken: '213ea880a581ccf8af5e6cb132a269d4', 
    spFriendDomain: 'http://frd.baidu.com',
    spSpaceDomain: 'http://hi.baidu.com',
    spPortraitDomain: 'http://tx.bdimg.com',
    spSpaceStaticDomain: 'http://hi.bdimg.com', /*{cmt TODO RD似乎还不有提供这个变量，记得补成呀！}*/
    spImgDomain : 'http://img.baidu.com',
    spStaticDomain : 'http://hi.bdimg.com',

    isDrag: false  /*{cmt 是否在拖动页：是为了通用，只对模块内容有作用，这里也作为一个通用属性}*/
    ,isProfile: false   /*{cmt 是否在拖动页：是为了通用，只对模块内容有作用，这里也作为一个通用属性}*/
    ,isPortraitVerify:!true
    };
</script></head><body> <script>
/*<![CDATA[*/
if(top.location != self.location){
	top.location = self.location;
}
var myref = encodeURIComponent("http://hi.baidu.com\/x3030\/blog\/item\/b119f61ae15ab415c83d6d49.html");
/*]]>*/
</script><!--[if (lt IE 8.0)]><link rel=stylesheet type=text/css href="http://hi.bdimg.com/static/cblog/css/ui/mods.css?v=54b8559f.css"><![endif]--><!--[if (!IE)|(gte IE 8.0)]><!--><link rel=stylesheet type=text/css href="http://hi.bdimg.com/static/cblog/css/ui/mods_datauri.css?v=a1661a70.css"><!--<![endif]--><link rel=stylesheet type=text/css href="http://hitn.bdimg.com/2402050202/css/item/919e9e864b84d97f9f2fb464.css"><!--[if (lt IE 8.0)]><link rel=stylesheet type=text/css href="http://hi.bdimg.com/static/cblog/css/space.css?v=325179d8.css"><![endif]--><!--[if (!IE)|(gte IE 8.0)]><!--><link rel=stylesheet type=text/css href="http://hi.bdimg.com/static/cblog/css/space_datauri.css?v=a4a7a2f2.css"><!--<![endif]--><div class=userbar><center> <div id=nav><a class=logo href=http://hi.baidu.com/index.htm><img src=http://img.baidu.com/hi/logo/logo_93_30.gif border=0 alt="百度空间"></a><div class="manage no-login"> <script src="http://hi.bdimg.com/static/base/js/spaceAPI4PassportHandler.js?v=43198164.js"></script> <div id=topbarLoginForCblog class=topbar-login-form></div><a href=/reg/new class=reglink>注册</a></div> <script>
                SpaceAPI4Passport.login({outDomId: 'topbarLoginForCblog', isTopBar: true, afterReady: function(form) {
                    var button = baidu.q('pass_login_input_submit', form)[0];
                        baidu.dom.hide(button);
                    var href = baidu.dom.create('a', {
                        id: 'loginLink',
                        href: '#',
                        className: 'loginlink'
                    });
                    href.innerHTML = '登录';
                    baidu.on(href, 'click', function() {
                        baidu.event.fire(button, 'click');
                    });
                    baidu.dom.insertAfter(href, form);
                }});
            </script> </div></center></div><script src="http://hi.bdimg.com/static/base/js/conf/base.js?v=1343198164.js"></script><link rel=stylesheet type=text/css href="http://hi.bdimg.com/static/base/css/base.css?v=1343198164.css"><script language=javascript src="http://hi.bdimg.com/static/cblog/js/ui/dialog.js?v=f1d92f7b.js"></script><center><div id=main align=left><!--[if IE]><script>
var objmain = document.getElementById("main");
function updatesize(){ var bodyw = window.document.body.offsetWidth; if(bodyw <= 790) objmain.style.width="772px"; else if(bodyw >= 1016) objmain.style.width="996px"; else objmain.style.width="100%"; }
updatesize(); window.onresize = updatesize;
</script><![endif]--><div id=header><div class=lc><div class=rc></div></div><div class=tit><a href="/x3030" class=titlink title="x3030的空间 http://hi.baidu.com/x3030">谢灬向</a></div><div class=desc>谢灬向 dos 批处理 html 网站 精品 笑话 知识 教程 c语言 c++  javascript css vbs</div><div id=tabline>&nbsp;</div><div id=tab><a href="http://hi.baidu.com/x3030/home">主页</a><a href="http://hi.baidu.com/x3030/blog" class=on>博客</a><a href="http://hi.baidu.com/x3030/album">相册</a><span>|</span><a href="http://hi.baidu.com/x3030/profile">个人档案</a><span>|</span><a href="http://hi.baidu.com/x3030/friends">好友</a><span>|</span><a href="http://tieba.baidu.com/i/sys/jump?un=x3030&fr=spacebar" onclick="BdUtil.ns_trackerLink('m_20110330_spacebar','')" target=_blank>i贴吧</a></div></div><div class=stage><div class=stagepad><div style="width:100%"><table width="100%" border=0 cellspacing=0 cellpadding=0 class=modth><tr><td class=modtl width=7>&nbsp;<td class=modtc nowrap><div class=modhead><span class=modtit>查看文章</span></div><td class=modtc nowrap align=right><td class=modtr width=7>&nbsp;</table><div id=m_blog class=modbox style="overflow-x:hidden;"><div class=tit>VC打开、保存文件对话框和浏览文件夹对话框</div><div class=date>2011年11月06日 星期日 2:11</div><table style="table-layout:fixed;width:100%"><tr><td><div id=blog_text class=cnt><p>一、打开文件夹：<br />1、CFileDialog实现</p>
<p>CFileDialog hFileDlg(true,NULL,NULL,<br />&nbsp;&nbsp; OFN_FILEMUSTEXIST | OFN_READONLY | OFN_PATHMUSTEXIST,<br />&nbsp;&nbsp; TEXT(&quot;驱动文件 (*.sys)|*.sys|所有文件(*.*)|*.*|&quot;),NULL);<br />if(hFileDlg.DoModal() == IDOK)<br />{<br />&nbsp;m_path = hFileDlg.GetPathName();<br />&nbsp;&nbsp;&nbsp; UpdateData(FALSE);<br />}</p>
<p>&nbsp;</p>
<p>2、API实现<br />OPENFILENAMEA ofn;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />char szFile[260];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />ZeroMemory(&amp;ofn, sizeof(ofn));<br />ofn.lStructSize = sizeof(ofn);<br />ofn.hwndOwner = NULL;<br />ofn.lpstrFile = szFile;<br />ofn.lpstrFile[0] = '/0';<br />ofn.nMaxFile = sizeof(szFile);<br />ofn.lpstrFilter = &quot;音频文件/0*.wma/0&quot;;<br />ofn.nFilterIndex = 1;<br />ofn.lpstrFileTitle = NULL;<br />ofn.nMaxFileTitle = 0;<br />ofn.lpstrInitialDir = NULL;<br />ofn.Flags = 0;</p>
<p>if (GetOpenFileNameA(&amp;ofn)==FALSE) <br />&nbsp;&nbsp; return S_FALSE;<br />CString c_save_path=ofn.lpstrFile;</p>
<p>二、保存文件<br />同上，只不过将“ CFileDialog hFileDlg(true,NULL ”改为“ CFileDialog hFileDlg(false,NULL ”，或者将GetOpenFileNameA改为GetSaveFileNameA，即可。</p>
<p>三、浏览文件夹对话框<br />//回调函数<br />int CALLBACK BrowseCallbackProc(HWND hwnd, UINT uMsg, LPARAM lParam, LPARAM lpData)<br />{<br />&nbsp;&nbsp;&nbsp; if(uMsg==BFFM_SELCHANGED||uMsg==BFFM_INITIALIZED)<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(uMsg==BFFM_INITIALIZED)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ::SendMessage(hwnd,BFFM_SETSELECTION,TRUE,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LPARAM(lpData));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; return 0;<br />}</p>
<p><br />TCHAR chPath[255]; //用来存储路径的字符串<br />CString strPath = &quot;&quot;;<br />BROWSEINFO bInfo;<br />GetModuleFileName(NULL,chPath,MAX_PATH);<br />strPath=chPath;<br />ZeroMemory(&amp;bInfo, sizeof(bInfo));<br />bInfo.hwndOwner = m_hWnd;<br />bInfo.lpszTitle = _T(&quot;请选择路径: &quot;);&nbsp;&nbsp;&nbsp;&nbsp; <br />bInfo.ulFlags&nbsp;&nbsp; = BIF_RETURNONLYFSDIRS|BIF_EDITBOX;<br />bInfo.lpfn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = BrowseCallbackProc;<br />bInfo.lParam&nbsp;&nbsp;&nbsp; = (LPARAM)strPath.GetBuffer(strPath.GetLength());</p>
<p>LPITEMIDLIST lpDlist; //用来保存返回信息的IDList<br />lpDlist = SHBrowseForFolder(&amp;bInfo) ; //显示选择对话框<br />if(lpDlist != NULL) //用户按了确定按钮<br />{<br />&nbsp;&nbsp; SHGetPathFromIDList(lpDlist, chPath);//把项目标识列表转化成字符串<br />&nbsp;&nbsp; strPath = chPath; //将TCHAR类型的字符串转换为CString类型的字符串<br />&nbsp;&nbsp; m_save_path=strPath;<br />&nbsp;&nbsp; UpdateData(FALSE);<br />}<br /></p></div></table><br><div class=opt id=blogOpt><a href="http://hi.baidu.com/x3030/blog/category/c%D3%EF%D1%D4%B3%CC%D0%F2%C9%E8%BC%C6" title="查看该分类中所有文章">类别：c语言程序设计</a><span class=x-blog-opt-sp>|</span><a href="#" onclick="addToShare(); return false;" target=_blank><img src=http://img.baidu.com/hi/apps/share/share_btn.gif border=0 align=absbottom></a><span class=x-blog-opt-sp>|</span><a title="将此文章添加到百度搜藏" href=http://cang.baidu.com/do/add onClick="return addToFavor();" target=_blank>添加到搜藏</a> <span class=x-blog-opt-sp>|</span><a title="将此文章分享到i贴吧" href="#" onclick="addToiTieba(); return false;" target=_blank>分享到i贴吧</a><span class=x-blog-opt-sp>|</span>浏览(<span id=result>222</span>)<span class=x-blog-opt-sp>|</span><a href="#send">评论</a>&nbsp;(<span id=blogCmtCount>0</span>)<script language=javascript>
										/*<![CDATA[*/
										var pre = [true,'VC控制台输出时设置字体及背景颜色', 'VC控制台输出时设置字体及背景颜...','\/x3030/blog/item/186b24d815300ed850da4b43.html'];
										var post = [true,'hhp','hhp', '\/x3030/blog/item/074096e1867db03b63d09f53.html'];
										if(pre[0] || post[0]){
											document.write('<div style="height:5px;line-height:5px;">&nbsp;</div><div id="in_nav">');
											if(pre[0]){
												document.write('上一篇：<a href="' + pre[3] + '" title="' + pre[1] + '">' +  pre[2] + '</a>&nbsp;&nbsp;&nbsp;&nbsp;');
											}
											if(post[0]){
												document.write('下一篇：<a href="' + post[3] + '" title="' + post[1] + '">' +  post[2] + '</a>');
											}
											document.write('</div>');
										}
										/*]]>*/
									</script></div><div class=line>&nbsp;</div><style type="text/css">#in_related_doc a{text-decoration:none}</style><div id=in_related_tmp></div><div id=in_reader> <div class=tit>最近读者：</div></div><div class=line>&nbsp;</div><div id=in_comment> <a name=comment></a> <div class=tit>网友评论：</div> <span id=userCommentList></span> <div id=page></div></div><form action='/x3030/commit' id=blogCmtSubmitForm name=blogCmtSubmitForm method=post> <input type=hidden name=bdstoken value='213ea880a581ccf8af5e6cb132a269d4'> <input type=hidden name=ct value=8> <input type=hidden name=cm value=2> <input type=hidden name=spBlogID value='b119f61ae15ab415c83d6d49'> <input type=hidden name=spBlogCmtID value=''> <input type=hidden name=spRefURL value=''></form><div id=in_send><a name=send></a><form name=form1 id=popFormSubmit action="/x3030/commit" method=post onSubmit="return checkcmtform()"><input type=hidden name=bdstoken value="213ea880a581ccf8af5e6cb132a269d4"><input type=hidden name=ct value=8><input type=hidden name=cm value=1><input type=hidden name=spBlogID value="b119f61ae15ab415c83d6d49"><input type=hidden name=spRefURL id=spRefURL><script>
										    document.getElementById("spRefURL").value = window.location.href;
										</script><div class=tit>发表评论：</div><table width=620 border=0 cellspacing=5 cellpadding=0><tr><td class=f14>姓　名：<td><input type=text name=spBlogCmtor id=spBlogCmtor style=width:220px tabindex=1 onChange="checkname('spBlogCmtor')" maxlength=49 onFocus="hidErr(1);"><script>
                                                            document.write(" &nbsp;&nbsp; <a href='http://hi.baidu.com/st/reg.html' target='_blank'>注册</a>");
                                                            document.write(' | <a href="https://passport.baidu.com/?login&tpl=sp&tpl_reg=sp&u='+myref+'" onclick="BdUtil.relogin(); return false;">登录</a>');
														</script><div style=display:none id=nmerror>*姓名最长为50字节</div><tr id=1_err style=display:none><td>&nbsp;<td><div class=error id=1_err_con></div><tr><td class=f14>网址或邮箱：<td><input type=text name=spBlogCmtURL id=spBlogCmtURL style=width:360px maxlength=128 tabindex=2 onChange="checkeandu('spBlogCmtURL')" onFocus="hidErr(2);"> (选填)<script>
														G("spBlogCmtor").value="";
														G("spBlogCmtURL").value="";
													</script><tr id=2_err style=display:none><td>&nbsp;<td><div class=error id=2_err_con></div><tr><td valign=top class=f14 id=reTitle>内　容：<td><textarea name="spBlogCmtText" id="spBlogCmtText" style="width:520px;height:155px"  tabindex="3" onFocus="hidErr(3);" onclick="BdUtil.relogin(); return false;" ></textarea><tr id=3_err style=display:none><td>&nbsp;<td><div class=error id=3_err_con></div><tr><td valign=top class=f14>&nbsp;<td valign=top class=f14><input id=btn_ok name=btn_ok type=submit autocomplete=off onclick="BdUtil.relogin(); return false;" value="发表评论" tabindex=5>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#" id=cancleReLink onClick="canclereply(); return false;" style="display:none; font-size:12px;color:#666;">取消回复</a></table></form></div><br></div><table width="100%" border=0 cellspacing=0 cellpadding=0 height=8><tr><td class=modbl width=7>&nbsp;<td class=modbc>&nbsp;<td class=modbr width=7>&nbsp;</table></div></div></div></div><div class=clearfix></div><div style="text-align:center;margin:30px auto 15px;font-family:Arial,simsun;font-size:12px;"><div style="margin:0 auto 6px;"><a href=http://help.baidu.com/question?prod_en=space target=_blank style="color:#00C;">帮助中心</a><span>&nbsp;|&nbsp;</span><a href="http://tieba.baidu.com/f?kw=%B0%D9%B6%C8%BF%D5%BC%E4&fr=wwwt" target=_blank style="color:#00C;">空间客服</a><span>&nbsp;|&nbsp;</span><a href=http://tousu.baidu.com/hi/ target=_blank style="color:#00C;">投诉中心</a><span>&nbsp;|&nbsp;</span><a href=http://www.baidu.com/search/hi_contract.html target=_blank style="color:#00C;">空间协议</a></div><div style="color:#7A77C8;">&copy;2012&nbsp;Baidu</div></div></center><ul id=blogCmtContentList style="display:none;"></ul><script>	var g_blogTitle = 'VC打开、保存文件对话框和浏览文件夹对话框';
		var g_blogId = 'b119f61ae15ab415c83d6d49';
		var g_isAllowCmt =  true ;
		var g_isByShared =  false ;
		var g_isAddRelate =  true ;
		var g_latestReader = [
									["http:\/\/hi.baidu.com\/e","d4488195d5656605","e"],
									["http:\/\/hi.baidu.com\/linux_java_c","ff4b6c696e75785f6a6176615f63fc0d","linux_java_c"],
									["http:\/\/hi.baidu.com\/风火随变","0ddbb7e7bbf0cbe6b1e4140b","风火随变"],
									["http:\/\/hi.baidu.com\/阳光宅鱼","a408d1f4b9e2d5acd3e3ae0f","阳光宅鱼"],
									["http:\/\/hi.baidu.com\/guaiguaitu24","d7d7677561696775616974753234d70a","guaiguaitu24"],
									["http:\/\/hi.baidu.com\/fuzhou2007","ad7766757a686f7532303037d801","fuzhou2007"],
									["http:\/\/hi.baidu.com\/zjyflytosky","59ad7a6a79666c79746f736b79ae0b","zjyflytosky"],
									["http:\/\/hi.baidu.com\/xmery11111111","0e08786d6572736b797905","xmersky"],
								{}
			];
	</script><iframe id=submitiframe name=submitiframe src="http://hi.bdimg.com/static/cblog/html/blank.html?v=20111213" style="display:none;"></iframe><script src="http://hi.bdimg.com/static/base/js/conf/comment.js?v=1343198164.js"></script><script src="http://hi.bdimg.com/static/cblog/js/job/detailpage.js?v=23d0f2c9.js"></script><script>
/*<![CDATA[*/
/*{cmt
    这个相当一个代理器  
  在这里想实现一种这种加载效果：加载时注册（用一个 初始化数据.数组 记录要绑定的ID），文档ready后，按需加载js+css资源，js加载完，就初始化据执行

  有个问题，有些结构是 动态 执行这个绑定的，可能会发生资源还没有加载的情况。可以考虑给初始化数据，加一个标志位，说明加载完未，如果未，则把数据push到 初始化数据中(因为是用 dom.onxxx 的方式，所以不怕多次对同一个ID执行的问题)


  }*/
var SP = SP || {};
if(!SP.mycard){
    SP.mycard = new (function(){
        var me = this;
        var _cancleAction = Session.isDrag;  /*{cmt 标记在特殊情况下，所有的注册都被abort 如拖动页面}*/
        var _list = [];
        var _sourceLoaded = false;    /*{cmt 这里用了一种资源加载结束后，回调的机制，这个标志资源是否加载结束}*/
        me.bind = function (_id){
            if(_cancleAction){  //abort
                return;
            }
            if(!_sourceLoaded){
                _list.push(_id);
            } else {
                baidu.space.mycard.bind(_id);
            }
        }
        me.init = function (_config){
            _cancleAction = !!_config.cancle;
        }
        me.onSourceLoaded = function (){
            _sourceLoaded = true;
            baidu.space.mycard.init({portrait: Session.visitorPortrait});
            for(var i=0,len=_list.length; i<len; i++){
                baidu.space.mycard.bind(_list[i]);
            }
        }
    })();
    baidu.dom.ready(function(){
        BdAjax.loadCSS('http://hi.bdimg.com/static/cblog/css/ui/ucard/ucard.css?v=7d369171.css');
        BdAjax.loadJS('http://hi.bdimg.com/static/cblog/js/ui/ucard/ucard.js?v=de038701.js');
    });
}
SP.mycard.bind('m_blog');  /*{cmt 只有文档加载完才真正绑定，这里只是append记录 }*/
/*]]>*/
</script> <script>
            var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
            document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fe8043a1430ea88a1f832d078750c0c92' type='text/javascript'%3E%3C/script%3E"));
        </script>